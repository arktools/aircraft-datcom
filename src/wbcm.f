      SUBROUTINE WBCM (A,B,C,DB,XCG,XW,COSAIW,CMOB,WB,BW,BODY,
     1              WINGIN,ZAC,CMA,ALI,BAL0,ZW,WINGC,VORTEX,ZCG)
C
C*********          WING-BODY MOMENT CALCULATIONS      *****************
C
      COMMON /OVERLY/ NLOG,NMACH,II,NALPHA,IG
      COMMON /CONSNT/ PI,DEG,UNUSED,RAD
      COMMON /OPTION/ SREF,CBARR,ROUGFC,BLREF
      COMMON /FLGTCD/ FLC(160)
      COMMON /BDATA/  BD(762)
C
      DIMENSION ROUTID(2),Q2136B(3),Q21C(1)
C AJT DIMENSION A(195),B(49),C(51),WB(39),BW(21),BODY(121),WINGIN(101)
      DIMENSION A(1),B(1),C(1),WB(1),BW(1),BODY(1),WINGIN(1)
      DIMENSION C21C(6),X21C(13),Y21C(13)
      DIMENSION X38B(3),Y38B(3),C38B(6),VORTEX(41),WINGC(81)
C AJT DIMENSION X38B(3),Y38B(3),C38B(6),VORTEX(1),WINGC(1)
      DIMENSION AL0(6),CL(21),CD(21),DXACWB(21),CDA(6)
C
      DATA INC,IND,INE / 0, 0, 0 /
      DATA QAL / 4HALWB /
      DATA QCD / 4HCD0  /, QAC / 4HWBAC /
      DATA ROUTID/4HWBCM,4H    /,Q2136B/4H4.3.,4H2.2-,4H36-B/,
     1     Q21C/4H21C /
C
C **          FIGURE 4.3.2.2-36-B
C
      DATA X38B  /0.0,1.0,1.0E06/
      DATA Y38B  /0.0,0.50,0.50/
      DATA I38B  /0/
      DATA IN21C /0/
      DATA X21C /0.0,.025,.050,.075,.10,.15,.20,.30,.40,.50,.60,.70,.80/
      DATA Y21C /0.0,.056,.101,.130,.152,.190,.22,.266,.301,.33,.348,
     1           .365,.375/
C
      SSPN=WINGIN(4)
      TEMP0= 0.25*A(7)*(1.+A(27))*A(38)
C
C ****     SELECT VALUE OF(X-PRIME)AC/(C)RE AT (BETA*A)= ZERO
C
      WB(15)= 0.50
      IF(TEMP0.GE.1.00) GO TO 1000
C
C             FIGURE 4.3.2.1-36-B
C
      CALL TBFUNX(TEMP0,WB(15),DYDX,3,X38B,Y38B,C38B,I38B,MI,NG,
     1            0,0,Q2136B,3,ROUTID)
C
C ***     COMPUTE VALUE OF (X-PRIME)AC/(C)RE AT (BETA*A)= 4.0
C
 1000 RATIO= DB/(2.*SSPN)
      CALL TBFUNX(RATIO,BRAC,DYDX,13,X21C,Y21C,C21C,IN21C,MI,NG,
     1            0,0,Q21C,1,ROUTID)
      TEMP4= 0.25+(2.*SSPN-DB)/(2.*A(10))*A(44)*BRAC
C
C*********     IF (BETA*A).GT.ZERO AND .LT.4.0  USE ELLIPSE CURVE FIT
C         REVISIONS TO WBCM SUBROUTINE
C
      ARG=B(2)*A(7)
      IF(ARG.LT.4.0) GO TO 1010
      WB(14)= TEMP4
      GO TO 1030
C
C*********     COMPUTE (X-PRIME)AC/(C)RE USING ELLIPSE CURVE FIT
C
 1010 X1= 4.0
      Y1= WB(15)
      Y= TEMP4
      P= 4.0
      Q= ABS(Y-Y1)
      BB= -2.0*Y1
      CC= (Y1*Y1-Q*Q+((Q/P)**2)*(ARG-X1)**2)
      IF((BB*BB-4.*CC).GT.0.0) GO TO 1020
      WRITE(6,1210  )
      CALL EXIT
 1020 CONTINUE
C
C*********     SOLVE QUADRATIC EQUATION FOR WB(14), (NOTE, AA=1)
C
      YMAX= (-BB+SQRT(BB*BB-4.*CC))/2.0
      YMIN= (-BB-SQRT(BB*BB-4.*CC))/2.0
      WB(14)= YMAX
      IF(Y.LT.Y1) WB(14)= YMIN
 1030 WB(13)= WB(14)*A(10)/CBARR
      DXCG=XCG-(XW+.50*DB*A(62)*COSAIW)
      CLOWB=0.
      CALL TBFUNX(CLOWB,ALOWB,DYDX,NALPHA,BW(21),FLC(23),AL0,INE,MI,NG,
     1            1,1,QAL,1,ROUTID)
      CMOWB=CMOB+B(47)+BODY(121)*(ALOWB-BAL0)+CMA*(ALOWB-B(49)+ALI)
C
      XLN = (XW+0.5*DB*A(38))/DB
      XLA = (XW+WINGIN(6)+0.5*DB*A(80))/DB
      XLA = BD(1)/DB-XLA
      RN  = FLC(II+42)*A(122)
      DBM = 2.*SQRT(BD(3)/PI)
      WL  = 0.5+ZW/DBM
      VT  = 0.0
      THETA=WINGIN(11)/RAD
      HD  = 0.5
      DOB = 0.5*DBM/WINGIN(4)
      CALL WBCM0(A(120),A(38),WINGIN(16),XLN,XLA,A(118),WINGIN(62),
     1            THETA,WINGIN(93),WINGIN(94),RN,FLC(96),WL,VT,
     2           HD,DOB,FLC(II+2),CMOWB)
      IF(ABS(CMOWB) .LE. UNUSED) CMOWB = 0.0
      WB(16) = CMOWB
C
      DO 1040   J=1,NALPHA
         XAC=-BODY(J+120)*CBARR/BODY(J+100)+DXCG
         ANUM=XAC*BODY(J+100)/CBARR+C(6)*WB(4)*A(10)/CBARR+WB(13)*WB(5)
         IF(J .EQ. 1) WB(12)=ANUM/(BODY(101)+WB(4)+WB(5))
         WB12=ANUM/(BODY(J+100)+WB(4)+WB(5))
         DXACWB(J)=DXCG/CBARR-WB12
         IF(CMOB .EQ. UNUSED) CMOB = 0.0
 1040 CONTINUE
      DO 1190 J=1,NALPHA
C
C   CHECK FOR DENOMINATOR EQUAL TO ZERO
C
 1160    IF (WINGC(20+J).EQ.0.0) GO TO 1170
C
C   COMPUTE DELTA XCP WING-BODY
C
         DXCPWB=(WINGC(J)-B(47))/WINGC(J+20)
C
         GO TO 1180
 1170    DXCPWB=0.0
C
 1180    CONTINUE
C
C   COMPUTE DELTA XCP BODY-WING
C
         DXCPBW=A(173)/CBARR-WB(13)
C
C   COMPUTE DELTA CN VORTEX
C
         DCNV=VORTEX(1+J)*VORTEX(21+J)*VORTEX(1)*B(22+J)*WINGC(61)
C
C   COMPUTE BODY-WING CM
C
         BW(40+J)=BODY(40+J)
     1         +  B(47)
     2         + (WINGC(20+J)-WINGC(61)*ALI)*WB(2)*DXCPWB
     3         + WINGC(61)*ALI*WB(7)*DXCPWB
     4         + (WINGC(20+J)-WINGC(61)*ALI)*WB(3)*DXCPBW
     5         + WINGC(61)*ALI*WB(8)*DXCPBW
     6         +  DCNV*DXCPWB
     7         +  WINGC(40+J)*(ZW-ZCG)/CBARR
         IF(WINGC(J) .EQ. 2.*UNUSED) BW(J+40)=2.*UNUSED
 1190 CONTINUE
C
C*********                COMPUTE (CA)WB---BW(J+80)
C
      DO 1200  J=1,NALPHA
         BW(J+80)=BW(J)*COS(B(J+22)/RAD)-BW(J+20)*SIN(B(J+22)/RAD)
 1200 CONTINUE
      RETURN
 1210 FORMAT (30X,45H ELLIPSE CURVE FIT IN ERROR, WBCM SUBROUTINE  )
      END

      FUNCTION YUP(I,M,NY)
C
C     ----FUNCTION TO LOCATE AND UNPACK Y(I,J,K,L)
C     ----M CONTAINS NX2,NX1,NX3,NX4,I1,I3,I4 IN THAT ORDER.
C     ----ROUTINE UNPACKS 2 FLOATING POINT NUMBERS WITH 3 SIGNIFICANT
C     ----DIGITS EACH.
C
      LOGICAL FIRST
      DIMENSION M(7),NY(1)
      LRAW=I
      IF(M(1).GT.0)GO TO 1000
      M1=IABS(M(1))
      M12=M1*M(2)
      M123=M12*M(3)
      IF(M(2).NE.0)LRAW=LRAW+M1*(M(5)-1)
      IF(M(3).NE.0)LRAW=LRAW+M12*(M(6)-1)
      IF(M(4).NE.0)LRAW=LRAW+M123*(M(7)-1)
 1000 LT=LRAW/2
      IF(LRAW.NE.2*LT)GO TO 1010
C
C     ----KEEP LAST NUMBER IN PACKED WORD.
C
      FIRST=.FALSE.
      GO TO 1020
 1010 LT=LT+1
C
C     ----KEEP FIRST NUMBER IN PACKED WORD.
C
      FIRST=.TRUE.
 1020 N=NY(LT)
C
C     ----UNPACK
C
      NS1=1
      IF(N.LT.0)NS1=-1
      N=IABS(N)
      NOT3=N/1000
      ND2=N-1000*NOT3
      NOT6=NOT3/1000
      ND1=NOT3-1000*NOT6
      NOT7=NOT6/10
      NP2=NOT6-10*NOT7
      NOT8=NOT7/10
      NP1=NOT7-10*NOT8
      NOT9=NOT8/10
      NSPS=NOT8-10*NOT9
      NOT10=NOT9/10
      NS2=NOT9-10*NOT10
C
C     ----INTERPRET.
C
      D1=ND1
      IF(NS1.LT.0)D1=-D1
      D2=ND2
      IF(NS2.EQ.1)D2=-D2
      IF(NSPS.EQ.0)GO TO 1060
      IF(NSPS.EQ.1)GO TO 1030
      GO TO 1050
 1030 NP1=-NP1
 1040 NP2=-NP2
      GO TO 1060
 1050 IF(NSPS.EQ.2)GO TO 1040
      NP1=-NP1
 1060 D2=D2*10.**NP2
      D1=D1*10.**NP1
      IF(FIRST)GO TO 1070
      YA=D2
      GO TO 1080
 1070 YA=D1
 1080 YUP=YA
      RETURN
      END

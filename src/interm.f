      SUBROUTINE INTERM(IFLAG,NALPHA,ALPHA,ARRAY,NDMF,NAF)
C
C***  INTERMDIATE LOGIC FOR OUTPUT
C
      REAL NDM
      LOGICAL NDMF,NAF
	CHARACTER*4 FOR,FOR2,FOR3
      DIMENSION ALPHA(1),ARRAY(1),XCP(20)
      DIMENSION ICONT(12),ICONT2(4),ICONT3(10),FOR(50),FOR2(18)
     1         ,FOR3(42)
      COMMON /CONSNT/ CONST(4)
      EQUIVALENCE(CONST(3),UNUSED)
      DATA ICONT/7,8,8,9,3*8,5*10/,ICONT2/3*9,10/,ICONT3/9,9*10/
      DATA NW/50/,NW2/18/,NW3/42/
      DATA FOR /
     1 4H(0P ,4H1X  ,4H,1X,,4HF5. ,4H1,1X,4H,1X ,4H,1X,,4HF6. ,4H3,1X,
     2 4H,1X ,4H,1X,,4HF6. ,4H3,1X,4H,1X ,4H,1X,,4HF7. ,4H4,1X,4H    ,
     3 4H,1X,,4HF6. ,4H3,1X,4H,1X ,4H,1X,,4HF6. ,4H3,1X,4H,1X ,4H,1X,,
     4 4HF6. ,4H3,1X,4H,2X ,4H,1P ,4HE10.,4H3   ,4H,3X ,4H,1P ,4HE10.,
     5 4H3   ,4H,3X ,4H,1P ,4HE10.,4H3   ,4H,3X ,4H,1P ,4HE10.,4H3   ,
     6 4H,3X ,4H,1P ,4HE10.,4H3   ,4H)   /
      DATA FOR2 /
     1 4H(   ,4H34X ,4H,2X,,4HF5. ,4H1,2X,4H,2X ,4H,2X,,4HF5. ,4H3,2X,
     2 4H,1X ,4H,1X,,4HF7. ,4H3,1X,4H,4X ,4H,2X,,4HF6. ,4H3,2X,4H)   /
      DATA FOR3/
     1 4H(0P ,4H1X  ,4H,1X,,4HF7. ,4H2,1X,4H,2X ,4H,1P ,4HE10.,4H3   ,
     2 4H,3X ,4H,1P ,4HE10.,4H3   ,4H,4X ,4H,1P ,4HE10.,4H3   ,4H,3X ,
     3 4H,1P ,4HE10.,4H3   ,4H,3X ,4H,1P ,4HE10.,4H3   ,4H,3X ,4H,1P ,
     4 4HE10.,4H3   ,4H,3X ,4H,1P ,4HE10.,4H3   ,4H,3X ,4H,1P ,4HE10.,
     5 4H3   ,4H,3X ,4H,1P ,4HE10.,4H3   ,4H)   /
C
      GO TO (1000,1080,1090),IFLAG
 1000 KXCP=1
      DO 1070 I=1,NALPHA
          IF(KXCP.EQ.2) GO TO 1040
          IF(ARRAY(I+40).EQ.UNUSED.OR.ARRAY(I+60).EQ.UNUSED) GO TO 1030
          IF(ARRAY(I+40).NE.2*UNUSED) GO TO 1010
              XCP(I)=2*UNUSED
              GO TO 1070
 1010     IF(ARRAY(I+40).EQ.-UNUSED.OR.ARRAY(I+60).EQ.-UNUSED)GO TO 1020
              XCP(I)=1.0E20
              IF(ARRAY(I+60).NE.0) XCP(I)=ARRAY(I+40)/ARRAY(I+60)
              GO TO 1070
 1020     CONTINUE
              XCP(I)=-UNUSED
              GO TO 1070
 1030     KXCP=2
 1040     IF(ARRAY(I+120).EQ.UNUSED.OR.ARRAY(I+100).EQ.UNUSED) GO TO 106
     10
          IF(ARRAY(I+120).EQ.-UNUSED.OR.ARRAY(I+100).EQ.-UNUSED)
     1       GO TO 1050
              XCP(I)=1.0E20
              IF(ARRAY(I+100).NE.0) XCP(I)=ARRAY(I+120)/ARRAY(I+100)
              GO TO 1070
 1050     CONTINUE
              XCP(I)=-UNUSED
              GO TO 1070
 1060     CONTINUE
              XCP(I)=UNUSED
 1070 CONTINUE
      NDMF=.FALSE.
      NAF=.FALSE.
          CALL SWRITE(12,FOR,NW,ICONT,NALPHA,ALPHA,ARRAY(1),ARRAY(21)
     1       ,ARRAY(41),ARRAY(61),ARRAY(81),XCP,ARRAY(101),ARRAY(121)
     2       ,ARRAY(141),ARRAY(161),ARRAY(181),S,T,NDMF,NAF)
      RETURN
 1080 CONTINUE
          CALL SWRITE(4,FOR2,NW2,ICONT2,NALPHA,ALPHA,ARRAY(1),ARRAY(21)
     1               ,ARRAY(41),E,F,G,H,O,P,Q,R,S,T,NDMF,NAF)
      RETURN
 1090 CONTINUE
      NDMF=.FALSE.
      NAF=.FALSE.
          CALL SWRITE(10,FOR3,NW3,ICONT3,NALPHA,ALPHA,ARRAY(1),ARRAY(21)
     1              ,ARRAY(41),ARRAY(61),ARRAY(81),ARRAY(101),ARRAY(121)
     2              ,ARRAY(141),ARRAY(161),Q,R,S,T,NDMF,NAF)
      RETURN
      END

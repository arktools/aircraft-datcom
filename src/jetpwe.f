      SUBROUTINE JETPWE
C
C     ----SUBROUTINE COMPUTES JET POWER EFFECTS
C
      COMMON /POWER/  XX(12),AIETLJ,NENGSJ,THSTCJ,JIALOC,JEVLOC,JEALOC,
     1                JINLTA,JEANGL,JEVELO,AMBTMP,JESTMP,JELLOC,JETOTP,
     2                AMBSTP,JERAD
      COMMON /POWR/   ATP,DCLT(20),XBARIN,XINOCR,DEUDA,EPSLON,ATJ,
     1                DCLNJ(20),XEP,ZJP,XJP,XHP,AIN,VIN,TINOTJ,VJPOVI,
     2                ZJPORJ,DE,ZJPOBH,YTOB2H,DEBODE,ZJPXHP,SRTPCO,
     3                ZJDEXH,COMP1,PTEOPI,RJPORJ,RJP,DXPORJ,DXP,XEPC,
     4                XHPC,ZTP,ZJPRJP,DCLHE(20),ZBART,DCMT(20),XL,
     5                DCMNJ(20),DLH,DCME(20)
      COMMON /FLOLOG/ FLTC,OPTI,BO,WGPL,WGSC,SYNT,HTPL,HTSC,VTPL,VTSC,
     1                HEAD,PRPOWR,JETPOW,LOASRT
      COMMON /CONSNT/ PI,DEG,UNUSED,RAD
      COMMON /SYNTSS/ XCG,XW,ZW,ALIW,ZCG,XH,ZH,ALIH,XV,VERTUP,HINAX,
     1                XVF,SCALE,ZV,ZVF,YV,YF,PHIV,PHIF
      COMMON /OVERLY/ NLOG,NMACH,M,NALPHA
      COMMON /FLGTCD/ FLC(93)
      COMMON /OPTION/ SR,CBARR
      COMMON /WINGD/  A(195),B(49)
      COMMON /HTDATA/ AHT(195)
      COMMON /WHAERO/ C(51),D(55)
      COMMON /WINGI/  WINGIN(77)
      COMMON /HTI/    HTIN(131)
      COMMON /IWING/  PWING, WING(400)
      COMMON /IHT/    PHT, HT(380)
      COMMON /IDWASH/ PDWASH,DWASH(60)
      COMMON /IPOWER/ PPOWER, DCDPOW(20),DCLPOW(20),DCMPOW(20)
      LOGICAL VERTUP
      LOGICAL FLTC,OPTI,BO,WGPL,WGSC,SYNT,HTPL,HTSC,VTPL,VTSC,
     1        HEAD,PRPOWR,JETPOW,LOASRT
      LOGICAL LOGCOM(11)
      REAL MACH(20)
      REAL NENGSJ,JIALOC,JEVLOC,JEALOC,JINLTA,JEANGL,JEVELO,JESTMP,
     1     JELLOC,JETOTP,JERAD
      EQUIVALENCE (CDL(1),D(36)),(CLW(1),WING(21))
      EQUIVALENCE (ALSCHD(1),FLC(23)),(MACH(1),FLC(3))
      EQUIVALENCE (A(120),AR),(ALPHA0,A(134))
      EQUIVALENCE (LOGCOM(1),FLTC)
      EQUIVALENCE (BO2H,HTIN(4)),(CLALPH,HT(101)),(QHOQI(1),DWASH(1)),
     1            (XBARRH,AHT(161))
      DIMENSION CLW(20),CDL(20)
      DIMENSION ALSCHD(20)
      DIMENSION ROUTID(2),Q44161(2),Q46128(2),Q46129(2),Q46131(2),
     1          Q6132A(3),Q6132B(3),Q46114(2)
      DIMENSION QHOQI(20)
      DIMENSION X16114(6),X26114(8),Y46114(48)
      DIMENSION X16117(13),X26117(4),Y46117(52)
      DIMENSION X6118A(8),Y6118A(8) , C6118A(6)
      DIMENSION X6118B(8),Y6118B(8),C6118B(6)
      DIMENSION X6119A(9),Y6119A(9),C6119A(6)
C
C     ----TABLES FOR UPWASH GRADIENT AT PLANE OF SYMMETRY FOR UNSWEPT
C     ----WINGS. FIGURE 4.4.1-73
C
      DIMENSION X14161(4),X24161(10),Y44161(10,4)
      DATA Q44161/4H4.4.,4H1-73/,Q46128/4H4.6.,4H1-28/,ROUTID/4HJETP,
     1 4HWE  /, Q46129/4H4.6.,4H1-29/,Q46131/4H4.6.,4H1-31/,
     2 Q6132A/4H4.6.,4H1-32,4HA   /,  Q46114/4H4.6.,4H1-28/,
     3 Q6132B/4H4.6.,4H1-32,4HB   /
      DATA X14161/4.,6.,9.,12./
      DATA X24161/.25,.4,.5,.6,.7,.8,1.0,1.2,1.6,2.0/
      DATA Y44161/1.08,.545,.40,.31,.24,.20,.13,.10,.06,.04 , 1.18,.680,
     1.52,.40,.32,.27,.19,.15,.10,.08 , 1.30,.81,.62,.49,.40,.34,.25,.20
     2,.13,.12 , 1.4,.88,.70,.56,.445,.39,.30,.24,.165,.14 /
C
C    -----FIGURE 4.6.1-28
C     -----EFFECTIVE MEAN DOWNWASH ACTING ON HORIZONTAL TAIL
C
      DATA X16114/0.0,0.3,0.5,0.7,0.9,1.1/
      DATA X26114/0.0,0.2,0.4,0.6,0.8,1.0,1.2,1.4/
      DATA Y46114/0.0,0.54,0.765,0.860,0.915,0.950,0.969,0.988,
     10.0,0.51,0.721,0.825,0.890,0.923,0.950,0.970,
     20.0,0.450,0.675,0.790,0.860,0.900,0.922,0.945,
     30.0,0.395,0.595,0.725,0.810,0.861,0.892,0.914,
     40.0,0.300,0.522,0.660,0.748,0.810,0.859,0.890,
     50.0,0.200,0.415,0.570,0.682,0.758,0.810,0.850/
C
C    -----FIGURE 4.6.1-29
C    -----VARIATION OF EQUIVALENT VELOCITY RATIO,WITH ACTUAL VELOCITY RA
C
      DATA X16117/0.46,0.42,0.38,0.34,0.32,0.30,0.28,0.26,0.24,0.22,
     1.20,0.16,0.12/
      DATA X26117/1.0,6.0,14.0,24.0/
      DATA Y46117/1.0,4.25,9.66,16.6, 1.0,4.10,9.21,15.7, 1.0,3.90,8.80,
     114.9, 1.0,3.85,8.35,14.10, 1.,3.6,8.1,13.7, 1.,3.55,7.89,13.3,
     21.0,3.40,7.60,12.90,   1.0,3.30,7.40,12.40,   1.0,3.20,7.10,12.0,
     31.0,3.10,6.80,11.40,   1.0,3.00,6.50,11.00,   1.0,2.72,5.90,9.85,
     41.0,2.42,5.15,8.55/
C
C    -----FIGURE 4.6.1-31
C    -----DOWNWASH INCREMENT DUE TO A SUBSONIC JET IN A SUBSONIC STREAM
C
      DATA I6118A/0/
      DATA X6118A/0.0,0.4,0.8,1.2,1.6,2.0,2.4,2.6/
      DATA Y6118A/0.0,0.34,0.63,0.88,1.1,1.31,1.51,1.61/
C
C    -----FIGURE 4.6.1-32A
C    -----EQUIVALENT JET ORIFICE RADIUS FOR SUPERSONIC JET IN A SUBSONIC
C    -----STREAM
C
      DATA I6118B/0/
      DATA X6118B/3.0,4.0,6.0,8.0,10.0,12.0,14.0,16.0/
      DATA Y6118B/1.08,1.30,1.70,2.02,2.23,2.41,2.55,2.70/
C
C    -----FIGURE 4.6.132B
C    -----DOWNSTREAM DISPLACEMENT OF EQUIVALENT JET ORIFICE LOCATION
C    -----FOR A SUPERSONIC JET IN A SUBSONIC STREAM
C
      DATA I6119A/0/
      DATA X6119A/1.0,1.2,1.4,1.6,1.8,2.0,2.2,2.4,2.6/
      DATA Y6119A/0.0,1.0,1.6,2.07,2.40,2.65,2.86,3.04,3.16/
C
      TMPINK(T)=273.+.556*(T-492.)
      TPCNE=NENGSJ*THSTCJ
      COSAIW=COS(DEG*ALIW)
      IF(NENGSJ.EQ.1.)GO TO 1010
      IF(WINGIN(2).EQ.UNUSED) GO TO 1010
      IF(JELLOC .LE.WINGIN(4)-WINGIN(2)) GO TO 1000
      CRJ=WINGIN(5)-(WINGIN(5)-WINGIN(1))*((JELLOC -(WINGIN(4)
     1   -WINGIN(2)))/WINGIN(2))
      XBARJ=(XW+A(38)*(WINGIN(4)-WINGIN(2))+A(86)*(JELLOC -(WINGIN(4)
     1      -WINGIN(2)))-JIALOC)*COS(DEG*ALIW)/CRJ
      GO TO 1020
 1000 WINGIN(1)=SAVE
      WINGIN(1)=WINGIN(5)
 1010 CRJ=WINGIN(6)-(WINGIN(6)-WINGIN(1))*JELLOC /WINGIN(4)
      XBARJ=(XW+A(38)*JELLOC +CRJ/4.0-JIALOC)*COS(DEG*ALIW)/CRJ
 1020 CONTINUE
      SAVE=WINGIN(1)
C
C     ----FIG 4.4.1-73
C
      CALL TLINEX(X14161,X24161,Y44161,4,10,AR,XBARJ,DEUDA,
     1            2,2,2,2,Q44161,2,ROUTID)
      AINNE2=2.0*JINLTA*NENGSJ/SR
      SINAIT=SIN(DEG*AIETLJ)
      COSAIT=COS(DEG*AIETLJ)
C
C     ----GEOMETRIC COMPUTATIONS IF TAIL PRESENT.
C
      IF(.NOT.HTPL)GO TO 1090
      COSAIH=COS(DEG*ALIH)
      XEP=(XH+XBARRH*COSAIH-JEALOC)
      TANTHJ=TAN(DEG*JEANGL)
      ZT=JEVLOC+JERAD*SINAIT/TANTHJ
      ZJP=XEP*SINAIT+(ZH-ZT)*COSAIT
      XEP=XEP/COSAIT
      XJP=4.6*JERAD
      XHP=XJP+XEP
      AIN=49.0*SQRT(AMBTMP)
      VIN=MACH(M)*AIN
      VJOVIN=JEVELO/VIN
      XEPORJ=XEP/JERAD
      ZJPOBH=ZJP/(2.0*BO2H)
      YTOB2H=JELLOC/BO2H
C
C     ----FIGURE 4.6.1-28 EFF. MEAN DOWNWASH ACTING ON HORT. TAIL
C
      CALL TLINEX(X16114,X26114,Y46114,6,8,YTOB2H,ZJPOBH,DEBODE,
     1            0,0,2,2,Q46114,2,ROUTID)
      KASE=3
      IF(JEVELO.GE.AIN)GO TO 1030
      KASE=1
      IF(XEPORJ.GT.16.0)KASE=2
 1030 GO TO (1040,1060,1070),KASE
C
C     ----COMPUTE PART OF CASE 1 WHICH IS NOT A FUNCTION OF ALPHA
C     ----SUBSONIC FREE STREAM , SUBSONIC JET . HORIZONTAL TAIL .LT. 8
C     ----EXIT DIAMETERS DOWNSTREAM OF JET EXIT PLANE.
C
 1040 TINOTJ=TMPINK(AMBTMP)/TMPINK(JESTMP)
C
C     ----FIGURE 4.6.1-29 VAR. OF EQUIV. VEL. RATIO TO ACTUAL VEL. RATIO
C
      CALL TLINEX(X16117,X26117,Y46117,13,4,TINOTJ,VJOVIN,VJPOVI,
     1            2,0,2,1,Q46129,2,ROUTID)
      IF(KASE.EQ.3) GO TO 1050
      ZJPORJ=ZJP/JERAD
C
C     ----FIGURE 4.6.1-31 A-C
C     ----FIGURE 4.6.1-31 DOWNWASH INCREMENT DUE TO A SUBSONIC JET IN A
C     ----SUBSONIC STREAM.
C
 1050 CALL FG6115(DE,XEPORJ,ZJPORJ,VJPOVI)
      GO TO 1080
C
C     ----COMPUTE PART OF CASE II WHICH IS NOT A FUNCTION OF ALPHA
C     ----SUBSONIC FREE STREAM SUBSONIC JET,HORIZONTAL TAIL LOCATED
C     ---MORE THAH 8 EXIT DIAMETERS DOWNSTREAM OF JET EXIT PLANE.
C
 1060 ZJPXHP=ZJP/XHP
      SRTPCO=SR*THSTCJ/(XHP**2)
C
C     ----FIGURE 4.6.1-31 DOWNWASH INCREM. SUBSON JET IN SUB. STREAM
C
      CALL TBFUNX(SRTPCO,ZJDEXH,Q,8,X6118A,Y6118A,C6118A,I6118A,MI,NG,
     1            0,1,Q46131,2,ROUTID)
      DE=ZJDEXH/ZJPXHP
      GO TO 1080
C
C     ----CASE III SUBSONIC FREE STREAM,SUPERSONIC JET,HORTZ TAIL IS
C         DOWNSTREAM OF THE FULLY EXPANDED FLOW.
C
 1070 PTEOPI=JETOTP/AMBSTP
C
C     ----FIGURE 4.6.1-32A
C
      CALL TBFUNX(PTEOPI,RJPORJ,Q,8,X6118B,Y6118B,C6118B,I6118B,MI,NG,
     1            2,2,Q6132A,3,ROUTID)
      RJP=JERAD*RJPORJ
C
C     ----FIGURE 4.6.1-32B
C
      CALL TBFUNX(RJPORJ,DXPORJ,Q,9,X6119A,Y6119A,C6119A,I6119A,MI,NG,
     1            0,2,Q6132B,3,ROUTID)
      DXP=DXPORJ*JERAD
      XEPC=XEP+DXP
      XHPC=XEPC+RJP/TANTHJ
      ZTP=JEVLOC-DXP*SINAIT
      ZJP=XHPC*SINAIT+COSAIT*(ZH-ZTP)
      ZJPOBH=ZJP/(2.0*BO2H)
      CALL TLINEX(X16114,X26114,Y46114,6,8,YTOB2H,ZJPOBH,DEBODE,
     1            0,0,2,2,Q46128,2,ROUTID)
      ZJPORJ=ZJP/RJP
      XEPORJ=XEPC/RJP
      GO TO 1040
 1080 COMP1=CLALPH*DE*DEBODE
C
C     ----COMPUTE JET POWER EFFECTS ON PITCHING MOMENT DUE TO OFFSET OF
C     ----THRUST AXIS
C
 1090 ZBART=COSAIT*(JEVLOC-ZCG)+SINAIT*(JEALOC-XCG)
      DCMT(1)=-THSTCJ*ZBART*NENGSJ/CBARR
 1100 CONTINUE
      DO 1110 J=1,NALPHA
C
C     ----COMPUTE LIFT COMPONENT DUE TO THRUST VECTOR (DCL)T
C
         ATP=ALSCHD(J)+AIETLJ
         SINATP=SIN(DEG*ATP)
         DCLT(J)=TPCNE*SINATP
C
C     ----COMPUTE LIFT DUE TO INCLINATION OF THRUST LINE
C
         EPSLON=DEUDA*(ALIW+ALSCHD(J)-ALPHA0)
         ATJ=ALSCHD(J)+AIETLJ+EPSLON
         SINATJ=SIN(DEG*ATJ)
         DCLNJ(J)=AINNE2*SINATJ
C
C     ----COMPUTE LIFT DUE TO HORIZONTAL TAIL IF IT IS PRESENT
C
         DCLHE(J)=0.0
         IF(HTPL)DCLHE(J)=COMP1*QHOQI(J)
C
C     ----COMPUTE TOTAL LIFT DUE TO POWER
C
         DCLPOW(J)=DCLNJ(J)+DCLT(J)+DCLHE(J)
C
C     ----COMPUTE JET POWER EFFECTS ON PITCHING MOMENT DUE TO NORMAL
C     ----FORCE ON THE ENGINE INLET.
C
         XL=JIALOC-XCG
         DCMNJ(J)=-DCLNJ(J)*XL/CBARR
C
C     ----COMPUTE JET POWER EFFECTS ON PITCHING MOMENT DUE TO THE CHANGE
C     ----IN ANGLE OF ATTACK OF THE HORIZONTAL TAIL.
C
         DLH=XH+XBARRH*COSAIH-XCG
         DCME(J)=-DCLHE(J)*DLH/CBARR
C
C     ----TOTAL JET POWER EFFECTS ON PITCHING MOMENT
C
         DCMPOW(J)=DCMT(1)+DCMNJ(J)+DCME(J)
C
C     ------A SINGLE ENGINE JET CHANGES THE BASE PRESSURE AND THUS
C     ALTERS CDO HOWEVER NO METHODS ARE DEFINED FOR THIS CHANGE IN DRAG
C     -------JET EFFECTS DO NOT CAUSE A CHANGE IN INDUCED DRAG
C     BECAUSE THEY DO NOT MODIFY THE AERODYNAMIC LIFT OF THE WING
C
         DCDPOW(J) = 0.0
 1110 CONTINUE
      RETURN
      END

      SUBROUTINE PTCP(RSP,TOR,CASENO,PSTROT,TCPOUT)
C
C***  CALCULATES SUBSONIC CONTROL/FLAP PRESURE RATIO RATIO AND CP
C
      COMMON /CONSNT/ PI,DR,UNUSED,RAD
      COMMON /WINGD/  A(195)
      COMMON /POWR/   SPR(59)
      DIMENSION PP(19),AREA(19),SUMA(19),AMON(19),SUMM(19),TCP(19)
     1          ,PSTR(19),RR(19),CPSTR(6),CTCP(6)
      EQUIVALENCE(TANLLE,A(62)),(TANLTE,A(80)),(BETA,SPR(1)),
     1           (TANLHL,SPR(14))
      INTEGER CASENO
      LOGICAL ONLY10
      DATA RR/.1,.2,.3,.4,.5,.6,.7,.8,.9,1.,2.,3.,4.,5.,6.,7.,8.,9.,10./
C
 1000 TANLEB=TANLLE/BETA
      IPSTR=0
      ITCP=0
      ONLY10=.FALSE.
      IF(CASENO.GT.2.AND.CASENO.LT.7)ONLY10=.TRUE.
      IF(ONLY10)GO TO 1090
      IF(TOR.EQ.2.0)GO TO 1070
C
C     ---HERE FOR TIP . MACH CONE AREAS 1,2,7 AND 8 .
C
      TP1=1.0+TANLEB
      RINC=.1
      RP=.1
      DO 1010 K=1,19
         PP(K)=ARCCOS((TP1-RP)/(TP1+RP))/PI
         IF(K.EQ.10)RINC=1.0
         RP=RP+RINC
 1010 CONTINUE
      GO TO 1130
 1020 AREA(11)=.37500*PP(10)+.791667*PP(11)-.208333*PP(12)+.041667*PP(13
     1)
      AREA(12)=-.041667*PP(10)+.541667*PP(11)+.541667*PP(12)-.041667*PP(
     113)
      AREA(13)=.041667*PP(10)-.208333*PP(11)+.791667*PP(12)+.375000*PP(1
     13)
      AREA(14)=.375000*PP(13)+.791667*PP(14)-.208333*PP(15)+.041667*PP(1
     16)
      AREA(15)=-.041667*PP(13)+.541667*PP(14)+.541667*PP(15)-.041667*PP(
     116)
      AREA(16)=.041667*PP(13)-.208333*PP(14)+.791667*PP(15)+.375000*PP(1
     16)
      AREA(17)=.375000*PP(16)+.791667*PP(17)-.208333*PP(18)+.041667*PP(1
     19)
      AREA(18)=-.041667*PP(16)+.541667*PP(17)+.541667*PP(18)-.041667*PP(
     119)
      AREA(19)=.041667*PP(16)-.208333*PP(17)+.791667*PP(18)+.375000*PP(1
     19)
      SUMA(11)=SUMA(10)+AREA(11)
      DO 1030 K=11,19
         SUMA(K)=SUMA(K-1)+AREA(K)
 1030 CONTINUE
      IF(TOR.EQ.1.0)GO TO 1220
 1040 AMON(11)=.37500*PP(10)+1.583333*PP(11)-.625000*PP(12)+.166667*PP(
     1           13)
      AMON(12)=-.041667*PP(10)+1.083333*PP(11)+1.625000*PP(12)-.166667*
     1           PP(13)
      AMON(13)=.041667*PP(10)-.416667*PP(11)+2.375000*PP(12)+1.500000*
     1         PP(13)
      AMON(14)=1.5000*PP(13)+3.958333*PP(14)-1.250000*PP(15)+.291667*
     1 PP(16)
      AMON(15)=-.166667*PP(13)+2.708333*PP(14)+3.250000*PP(15)-.291667*
     1 PP(16)
      AMON(16)=.166667*PP(13)-1.041667*PP(14)+4.750000*PP(15)+2.625*PP(
     1 16)
      AMON(17)=2.625*PP(16)+6.333333*PP(17)-1.875000*PP(18)+.416667*
     1 PP(19)
      AMON(18)=-.291667*PP(16)+4.333333*PP(17)+4.875000*PP(18)-.416667*
     1 PP(19)
      AMON(19)=.291667*PP(16)-1.666667*PP(17)+7.12500*PP(18)+3.75*PP(19)
      DO 1050 K=11,19
         SUMM(K)=SUMM(K-1)+AMON(K)
 1050 CONTINUE
      TM=.1
      R=.1
      DO 1060 K=1,19
         PSTR(K)=SUMA(K)/R
         IF(K.EQ.10)TM=1.0
         R=R+TM
         TCP(K)=SUMA(K)/(SUMA(K)+SUMM(K))
 1060 CONTINUE
      GO TO 1260
C
C     ----HERE FOR ROOT
C
 1070 TANSQ=TANLEB**2
      OMTTSQ=1.-2.*TANSQ
      TM=.1
      R=0.
      DO 1080 K=1,19
         IF(K.EQ.11)TM=1.0
         R=R+TM
         RP1SQ=(1.+R)**2
         PP(K)=ARCCOS((TANSQ+OMTTSQ*RP1SQ)/(RP1SQ-TANSQ))/PI
 1080 CONTINUE
      AREA(1)=.130786*PP(1)-.045340*PP(2)
      GO TO 1140
C
C     ----HERE FOR MACH CONE AREAS 3 AND 4 OR 5 AND 6.
C
 1090 IF(CASENO.GT.4)GO TO 1100
      TGEN=TANLTE
      GO TO 1110
 1100 TGEN=TANLHL
 1110 TGEN=TGEN/BETA
      IF(TOR.EQ.2.0)GO TO 1180
C
C     ----HERE FOR TIP
C
      OPTNOB=1.0+TANLEB
      TWTNTN=2.+TANLEB+TGEN
      TNDIF=TANLEB-TGEN
      EN=.1
      DO 1120 K=1,10
         PP(K)=ARCCOS((OPTNOB-TWTNTN*EN)/(OPTNOB-TNDIF*EN))/PI
         EN=EN+0.1
 1120 CONTINUE
 1130 AREA(1)=.113301*PP(1)-.032975*PP(2)
 1140 AREA(2)=.037500*PP(1)+.079167*PP(2)-.020833*PP(3)+.004167*PP(4)
      AREA(3)=-.004167*PP(1)+.054167*PP(2)+.054167*PP(3)-.004167*PP(4)
      AREA(4)=.004167*PP(1)-.020833*PP(2)+.079167*PP(3)+.037500*PP(4)
      IF(.NOT.ONLY10.AND.TOR.EQ.1.0)GO TO 1200
      IF(TOR.EQ.2.0)GO TO 1200
      AREA(5)=.041667*PP(4)+.066667*PP(5)-.008333*PP(6)
      AREA(6)=-.008333*PP(4)+.066667*PP(5)+.041667*PP(6)
      AREA(7)=.037500*PP(6)+.079167*PP(7)-.020833*PP(8)+.004167*PP(9)
      AREA(8)=-.004167*PP(6)+.054167*PP(7)+.054167*PP(8)-.004167*PP(9)
      AREA(9)=.004167*PP(6)-.020833*PP(7)+.079167*PP(8)+.037500*PP(9)
      AREA(10)=-.038494*PP(8)+.121105*PP(9)+.017389*PP(10)
      SUMA(1)=AREA(1)
      DO 1150 K=2,10
         SUMA(K)=AREA(K)+SUMA(K-1)
 1150 CONTINUE
      AMON(1)=.007917*PP(1)-.004167*PP(2)+.001250*PP(3)
      AMON(2)=.005417*PP(1)+.010833*PP(2)-.001250*PP(3)
      AMON(3)=-.002083*PP(1)+.015833*PP(2)+.011250*PP(3)
      AMON(4)=.011250*PP(3)+.031667*PP(4)-.010416*PP(5)+.002500*PP(6)
      AMON(5)=-.001250*PP(3)+.021667*PP(4)+.027083*PP(5)-.002500*PP(6)
      AMON(6)=.001250*PP( 3)-.008333*PP(4)+.039583*PP(5)+.022500*PP(6)
      AMON(7)=0.022500*PP(6)+.055417*PP(7)-.016667*PP(8)+.003750*PP(9)
      AMON(8)=-.002500*PP(6)+.037917*PP(7)+.043334*PP(8)-.003750*PP(9)
      AMON(9)=.002500*PP(6)-.014583*PP(7)+.063334*PP(8)+.033750*PP(9)
      AMON(10)=-.030795*PP(8)+.108995*PP(9)+.017389*PP(10)
      SUMM(1)=AMON(1)
      DO 1160 K=2,10
          SUMM(K)=AMON(K)+SUMM(K-1)
 1160 CONTINUE
      EN=.1
      DO 1170 K=1,10
         PSTR(K)=SUMA(K)/EN
         TCP(K)=(SUMA(K)-SUMM(K))/(SUMA(K)+TGEN*SUMM(K))
         EN=EN+.1
 1170 CONTINUE
      GO TO 1260
C
C     ----HERE FOR ROOT
C
 1180 EN=.1
      TSQ=TANLEB**2
      TMP=2.*(1.-TSQ)
      DO 1190 K=1,10
         PP(K)=ARCCOS(TMP/(1.-TSQ*((1.0-EN)/(1.-TGEN*EN))**2)-1.0)/PI
         EN=EN+.1
 1190 CONTINUE
      AREA(1)=.130786*PP(1)-.045340*PP(2)
      GO TO 1140
 1200 AREA(5)=.037500*PP(4)+.079167*PP(5)-.020833*PP(6)+.004167*PP(7)
      AREA(6)=-.004167*PP(4)+.054167*PP(5)+.054167*PP(6)-.004167*PP(7)
      AREA(7)=.004167*PP(4)-.020833*PP(5)+.079167*PP(6)+.037500*PP(7)
      AREA(8)=.037500*PP(7)+.079167*PP(8)-.020833*PP(9)+.004167*PP(10)
      AREA(9)=-.004167*PP(7)+.054167*PP(8)+.054167*PP(9)-.004167*PP(10)
      AREA(10)=.004167*PP(7)-.020833*PP(8)+.079167*PP(9)+.037500*PP(10)
      SUMA(1)=AREA(1)
      DO 1210 K=2,10
         SUMA(K)=AREA(K)+SUMA(K-1)
 1210 CONTINUE
      IF(.NOT.ONLY10.AND.TOR.EQ.1.0)GO TO 1020
 1220 AMON(1)=.006667*PP(1)-.001667*PP(2)
      AMON(2)=.006667*PP(1)+.008333*PP(2)
      AMON(3)=.007500*PP(2)+.023750*PP(3)-.008333*PP(4)+.002083*PP(5)
      AMON(4)=-.000833*PP(2)+.016250*PP(3)+.021667*PP(4)-.002083*PP(5)
      AMON(5)=.000833*PP(2)-.006250*PP(3)+.031667*PP(4)+.018750*PP(5)
      AMON(6)=.018750*PP(5)+.047500*PP(6)-.014583*PP(7)+.003333*PP(8)
      AMON(7)=-.002083*PP(5)+.032500*PP(6)+.037917*PP(7)-.003333*PP(8)
      AMON(8)=.002083*PP(5)-.012500*PP(6)+.055417*PP(7)+.030000*PP(8)
      AMON(9)=.033333*PP(8)+.060000*PP(9)-.008333*PP(10)
      AMON(10)=-.006667*PP(8)+.060000*PP(9)+.041667*PP(10)
      SUMM(1)=AMON(1)
      DO 1230 K=2,10
         SUMM(K)=AMON(K)+SUMM(K-1)
 1230 CONTINUE
      IF(.NOT.ONLY10.AND.TOR.EQ.1.0)GO TO 1040
      IF(.NOT.ONLY10)GO TO 1020
      EN=.1
      DO 1240 K=1,10
         PSTR(K)=SUMA(K)/EN
         EN=EN+.1
 1240 CONTINUE
      DO 1250 K=1,10
         TCP(K)=(SUMA(K)-SUMM(K))/(SUMA(K)-TGEN*SUMM(K))
 1250 CONTINUE
C
C     ----HERE FOR TABLE LOOKUP.
C
 1260 NP=19
      IF(ONLY10)NP=10
      CALL TBFUNX(RSP,PSTROT,DM,NP,RR,PSTR,CPSTR,IPSTR,MI,NG,0,0,4HPSTR,
     1            1,4HPTCP)
      CALL TBFUNX(RSP,TCPOUT,DM,NP,RR,TCP,CTCP,ITCP,MI,NG,0,0,4HTCP ,1,
     1            4HPTCP)
      RETURN
      END

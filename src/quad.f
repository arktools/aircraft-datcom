      SUBROUTINE QUAD(X,Y,XA,YA)
C
C***  COMPUTES PARAMETERS FOR QUADRATIC EXTRAPOLATION
C
      DIMENSION X(3),Y(3),X2(3)
      DATA DERIV/4HDERI/
      DET(A11,A12,A13,A21,A22,A23,A31,A32,A33)= A11*(A22*A33-A23*A32) -
     1 A21*(A12*A33-A13*A32) + A31*(A12*A23-A13*A22)
      DO 1000 I=1,3
 1000 X2(I)=X(I)**2
      D=DET(X2(1),X(1),1.,X2(2),X(2),1.,X2(3),X(3),1.)
      A=DET(Y(1),X(1),1.,Y(2),X(2),1.,Y(3),X(3),1.) /D
      B=DET(X2(1),Y(1),1.,X2(2),Y(2),1.,X2(3),Y(3),1.)/D
      C=DET(X2(1),X(1),Y(1),X2(2),X(2),Y(2),X2(3),X(3),Y(3))/D
C
C     ----TEST FOR TAKING DERIVATIVES
C
      IF(YA.EQ.DERIV)GO TO 1010
C
      YA=XA*(A*XA+B)+C
      RETURN
C
 1010 YA=2.*A*XA+B
      RETURN
      END

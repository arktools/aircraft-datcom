      SUBROUTINE SUPWBT(KDEODA,KQOQIN,KEPSLN)
C
C*** SUPERSONIC WING-BODY-TAIL CALCULATIONS
C
      DIMENSION ROUTID(2),Q1211A(3),Q1211B(3),Q31210(3),Q44167(2),
     1          Q1212A(3),Q1212B(3)
      REAL MACH,NXX,KWB,KBW,KKBW,KKWB
      REAL IVBH(20),IVWH(20)
      LOGICAL CANARD
      COMMON /CONSNT/ PI,DEG,UNUSED,RAD
      COMMON /OVERLY/ NLOG,NMACH,I,NALPH
      COMMON /WINGD/  A(195)
      COMMON /HTDATA/ AHT(195)
      COMMON /BDATA/  BD(762)
      COMMON /SUPWBB/  SWB(61)
      COMMON /SUPDW/  DWA(237)
      COMMON /SUPWH/  SLG(141),STG(141)
      COMMON /WBHCAL/ STP(156)
      COMMON /SUPBOD/ SBD(227)
      COMMON /WHWB/   FACT(182)
      COMMON /FLGTCD/ FLC(95)
      COMMON /OPTION/ SREF,CBARR,ROUGFC,BLREF
      COMMON /SYNTSS/ XCG,XW,ZW,ALIW,ZCG,XH,ZH,ALIH,XV,VERTUP,HINAX,
     1                XVF,SCALE,ZV,ZVF,YV,YF,PHIV,PHIF
      COMMON /BODYI/  NXX,XCOOR(20)
      COMMON /WINGI/  WINGIN(101)
      COMMON /HTI/    HTIN(154)
      COMMON /IBW/    PBW, BW(380)
      COMMON /IBWH/   PBWH, BWH(380)
      COMMON /IHT/    PHT, HT(380)
      COMMON /IBWHV/  PBWHV, BWHV(380)
      COMMON /IDWASH/ PDWASH, DWASH(60)
      COMMON /IWING/  PWING, WING(380)
      DIMENSION T4312B(8),D4312B(8)
      DIMENSION T4311A(36),D4311A(270),DUMYA(135),DUMYB(135)
      DIMENSION T4312A(11),D4312A(11)
      DIMENSION TFIG10(11),DKWB10(11),DKBW10(11)
      DIMENSION T4311B(23),D4311B(120)
      DIMENSION QOQINF(20),DEDALP(20),HMACH(20),CLAWBT(20),DELTAT(20)
      DIMENSION CNWBTV(20),CAWBTV(20)
      DIMENSION T4467(21),D4467(135)
      DIMENSION CCDWB(6),CC(6),EPSLON(40)
      DIMENSION LGH(4),VAR(4)
      DIMENSION CMWBT(20)
      DIMENSION GAMMA(20),CLTB(20),CLAH(20),CAA(6),CB(6),CLAHA(20)
      DIMENSION CDWBTV(20),CLH(20),CDWB(20),CDWBT(20),CMAH(20),
     1   CMAWBT(20),CLWB(20),CDAWB(20),CLWBT(20),CNWBT(20),CAWBT(20)
      EQUIVALENCE (XCSWPO,A(8)),(CD0VF,STP(156))
      EQUIVALENCE (CLAWB,BW(101)),(WSPAN,WINGIN(4)),
     1            (WKWB,SWB(35)),(WSPANS,WINGIN(3)),(STAILE,AHT(3)),
     2            (ARSTRW,A(7)),(TAPEXW,A(27))
      EQUIVALENCE (CNWBT(1),BWH(61)),(CAWBT(1),BWH(81)),(CNWBTV(1),
     1             BWHV(61)), (CAWBTV(1),BWHV(81))
      EQUIVALENCE (QOQINF(1),DWASH(1)),(DEDALP(1),DWASH(41))
     1           ,(HMACH(1),DWA(189)),(JDETCH,DWA(237))
      EQUIVALENCE (CD0V,STP(1)),(SPAN,HTIN(4)),(CR,HTIN(6))
     1           ,(CLAH(1),HT(101)),(CMAWB,BW(121)),(CD0H,STG(80))
      EQUIVALENCE (DD,STP(62)),(TRINO,STP(63)),(RKBW,STP(64)),(KBW,STP(
     1  65)),(KWB,STP(66)),(CLAHB,STP(67)),(CLABH,STP(68)),(YT,STP(69)),
     2(RCREO2,STP(70)),(IVWH(1),STP(71)),(DELTAT(1),STP(91)),(CLAWBT(1),
     3BWH(101)),(KKBW,STP(131)),(KKWB,STP(132)),(IVBH(1),STP(133)),
     4(GAMMA(1),STP(111)),(CDAWB(1),STP(42)),(EPSLON(1),DWASH(21))
     5,(CLTB(1),STP(22)),(CLWBT(1),BWH(21)),(DXACWB,STP(153))
      EQUIVALENCE (CMAH(1),STP(2)),(CMAWBT(1),BWH(121))
     1,(CD0WBV,STP(155)),(CDWBT(1),BWH(1)),(CDWBTV(1),BWHV(1))
     2,(CD0WBT,STP(154)),(CMWBT(1),BWH(41))
      EQUIVALENCE (CDWB(1),BW(1))
      EQUIVALENCE (CLWB(1),BW(21)),(TANLE,AHT(62)),(DN,SBD(4))
     1,(CRSTAR,AHT(10)),(TAPEXP,AHT(27))
     2,(CD0WB,SWB(4)),(SPANS,HTIN(3)),(ARSTAR,AHT(7)),(D1,SBD(5))
      EQUIVALENCE (D4311A(1),DUMYA(1)),(D4311A(136),DUMYB(1))
      DATA ROUTID/4HSUPW,4HBT  /,Q1211A/4H4.3.,4H1.2-,4H11A /,
     1                           Q1211B/4H4.3.,4H1.2-,4H11B /,
     2 Q31210/4H4.3.,4H1.2-,4H10  /,Q44167/4H4.4.,4H1-80/,
     3 Q1212A/4H4.3.,4H1.2-,4H12A /,
     4 Q1212B/4H4.3.,4H1.2-,4H12B /
C
C                   FIGURE 4.3.1.2-10 KWB
C
      DATA TFIG10/0.0,.1,.2,.3,.4,.5,.6,.7,.8,.9,1.0/
      DATA DKWB10/1.0,1.08,1.16,1.26,1.36,1.46,1.56,1.67,1.78,1.89,2.0/
C
C                   FIGURE 4.3.1.2-10 KBW
C
      DATA DKBW10/0.0,.13,.29,.45,.62,.80,1.0,1.22,1.45,1.70,2.0/
C
C                   FIGURE 4.3.1.2-12A (KBW)
C
      DATA T4312A/0.0,.1,.2,.3,.4,.5,.6,.7,.8,.9,1.0/
      DATA D4312A/0.0,.11,.21,.31,.41,.51,.6,.7,.8,.9,1.0/
C
C                   FIGURE 4.3.1.2-12B (KWB)
C
      DATA T4312B/0.,.1,.2,.3,.4,.6,.8,1./
      DATA D4312B/1.,.975,.956,.947,.941,.950,.978,1.0/
C
C              FIGURE 4.4.1-80(A,B,AND C)
C
      DATA T4467/
     1 0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,
     2 -4.0,-2.0,0.0,2.0,4.0,4*0.0,
     3 0.0,0.5,1.0/
      DATA D4467/
     1 0.785,0.700,0.625,0.565,0.515,0.490,0.475,0.470,0.470,
     2 0.785,0.700,0.625,0.565,0.515,0.490,0.475,0.470,0.470,
     3 0.785,0.710,0.645,0.600,0.570,0.555,0.540,0.540,0.540,
     4 0.785,0.735,0.695,0.670,0.645,0.630,0.620,0.610,0.600,
     5 0.785,0.750,0.730,0.710,0.700,0.690,0.685,0.680,0.675,
     6 0.785,0.680,0.600,0.540,0.500,0.480,0.475,0.485,0.505,
     7 0.785,0.710,0.645,0.600,0.580,0.565,0.560,0.565,0.570,
     8 0.785,0.735,0.700,0.675,0.660,0.650,0.640,0.635,0.630,
     9 0.785,0.800,0.810,0.810,0.800,0.790,0.770,0.740,0.710,
     A 0.785,0.810,0.830,0.845,0.855,0.855,0.850,0.835,0.810,
     B 0.785,0.685,0.605,0.550,0.510,0.505,0.530,0.580,0.645,
     C 0.785,0.710,0.670,0.640,0.635,0.650,0.670,0.720,0.770,
     D 0.785,0.775,0.780,0.790,0.805,0.820,0.845,0.875,0.905,
     E 0.785,0.815,0.840,0.865,0.885,0.905,0.915,0.925,0.930,
     F 0.785,0.830,0.870,0.900,0.920,0.935,0.940,0.940,0.935/
C
      CANARD=WINGIN(101) .GT. 2.5
      NALPHA=NALPH
      NA1=NALPH
      DO 990 J=1,NALPH
         IF(HT(J+20).NE.UNUSED.OR.CLWB(J).NE.UNUSED)GO TO 990
         NA1=J-1
  990 CONTINUE
      IF(TANLE.EQ.0.0)TANLE=.00001
      IF(KDEODA.NE.0.AND.KQOQIN.NE.0)GO TO 1000
      IF(JDETCH.EQ.0)RETURN
      IF(JDETCH.GT.0)NALPHA=JDETCH
      GO TO 1020
 1000 CONTINUE
      DO 1010 NN=1,NALPHA
 1010 HMACH(NN)=FLC(I+2)
 1020 NX=NXX+.5
      DCYL=(DN+D1)/2.
      MACH=FLC(I+2)
      BETA=SQRT(MACH**2-1.)
      RLB=XCOOR(NX)
      DD=2.0*(SPAN-SPANS)
      IF(NA1.LT.NALPHA)NALPHA=NA1
C
C   ***SUPERSONIC TAIL-BODY LIFT CURVE SLOPE,BODY IN PRESENCE OF TAIL***
C                         NON-TRIANGULAR TAILS
C
      IF(TAPEXP.EQ.0.0)GO TO 1080
      ARG1=BETA*ARSTAR*(1.0+TAPEXP)
      ARG2=1.+TANLE/BETA
      TRINO=ARG1*ARG2
      IF(TRINO.LE.4.)GO TO 1060
 1030 OLE=AHT(34)
      DX=RLB-XH-DD*AHT(38)-CRSTAR
      IF(DX.LE.(-CRSTAR))RKBW=0.
      IF(DX.LE.(-CRSTAR))GO TO 1050
      CALL INTKBW(MACH,OLE,CRSTAR,DD,DX,RKBW,RXAC)
 1050 KBW=RKBW/(RAD*BETA*(SREF/AHT(3))*CLAH(1)*(TAPEXP+1.)*
     1    (2.*SPAN/DD-1.))
      GO TO 1070
 1060 CONTINUE
      LGH(1)=11
      VAR(1)=DD/(2.*SPAN)
C
C                   FIGURE 4.3.1.2-10 KBW
C
      CALL INTERX(1,TFIG10,VAR,LGH,DKBW10,KBW,11,11,
     1            0,0,0,0,0,0,0,0,Q31210,3,ROUTID)
 1070 CONTINUE
      GO TO 1090
C
C  ***SUPERSONIC TAIL-BODY LIFT CURVE SLOPE,BODY IN PRESENCE OF TAIL***
C                         TRIANGULAR TAIL
C
 1080 CONTINUE
      ARG=BETA*ARSTAR
      IF(ARG.GT.1.)GO TO 1030
      GO TO 1060
 1090 CONTINUE
C
C  ***SUPERSONIC TAIL-BODY LIFT CURVE SLOPE
C
      VAR(1)=(SPAN-SPANS)/SPAN
      LGH(1)=11
C
C                   FIGURE 4.3.1.2-10 KWB
C
      CALL INTERX(1,TFIG10,VAR,LGH,DKWB10,KWB,11,11,
     1            0,0,0,0,0,0,0,0,Q31210,3,ROUTID)
      CLAHB=CLAH(1)*KWB
      CLABH=CLAH(1)*KBW
      IF(.NOT. CANARD) GO TO 1100
C
C     ********* COMPUTE WING VORTEX INTERFERENCE PARAMETERS *********
C
      BA=BETA*ARSTRW
      DBWO2=WSPAN-WSPANS
      LGH(1)=9
      LGH(2)=5
      LGH(3)=3
      VAR(1)=BETA*ARSTRW
      VAR(2)=A(120)*A(38)
      VAR(3)=TAPEXW
      CALL INTERX(3,T4467,VAR,LGH,D4467,YT,9,135,
     1            0,0,0,0,1,1,1,0,Q44167,2,ROUTID)
      BVTO2=WSPANS*YT+DBWO2
      Y0=BVTO2
 1100 CONTINUE
      RCREO2=SPAN-SPANS
      DO 1120 J=1,NALPHA
         IF(.NOT. CANARD) GO TO 1110
         Z0=A(12)-(A(24)-A(80)*BVTO2)*TAN((FLC(J+22)+ALIW)/RAD)
         IVWH(J)=ALI(Z0,Y0,SPANS,RCREO2,TAPEXP)
         ANUM=WING(101)*HT(101)*QOQINF(J)*WKWB*SPANS*IVWH(J)
         ADEN=2.0*PI*ARSTAR*(BVTO2-DBWO2)
         DELTAT(J)=(ANUM/ADEN)*RAD*SREF/STAILE
         CLAWBT(J)=CLAWB+(CLAHB+CLABH)*QOQINF(J)+DELTAT(J)
          FACT(J+121)=-DELTAT(J)/((CLAHB+CLABH)*QOQINF(J))
         GO TO 1120
 1110    CLAWBT(J)=CLAWB+(CLAHB+CLABH)*(1.0-DEDALP(J))*QOQINF(J)
 1120 CONTINUE
C
C     *********WING-BODY-TAIL LIFT AT ANGLE OF ATTACK ******************
C
      IF(ALIH.EQ.0.0.OR.(ALIH.EQ.UNUSED))GO TO 1130
C
C                   FIGURE 4.3.1.2-12A (KBW) INCIDENCE
C
      LGH(1)=11
      VAR(1)=(SPAN-SPANS)/SPAN
      CALL INTERX(1,T4312A,VAR,LGH,D4312A,KKBW,11,11,
     1            0,0,0,0,0,0,0,0,Q1212A,3,ROUTID)
C
C                   FIGURE 4.3.1.2-12B (KWB) INCIDENCE
C
      LGH(1)=8
      CALL INTERX(1,T4312B,VAR,LGH,D4312B,KKWB,8,8,
     1            0,0,0,0,0,0,0,0,Q1212B,3,ROUTID)
 1130 CLI=CLAH(1)*ALIH
      DETCL=0.0
      DCLOAL = 0.0
      XCBR4H=XH+AHT(161)
      CALL BODOWG(FLC(23),XCBR4H,RCREO2,SPAN,TAPEXP,
     1            IVBH,GAMMA,NALPHA)
      ARG1=KWB+KBW
      ARG2=(KKWB+KKBW)*CLI
      ARG3=CLAH(1)*(DD/(2.*SPAN))
      SINAI= SIN(ALIH/RAD)
      COSAI=COS(ALIH/RAD)
      TANAI=TAN(ALIH/RAD)
      BD(58)=(HTIN(4)-HTIN(3))*AHT(62)*COSAI
      BD(84)=XCG-(XH+BD(58))
      BD(762)=ZH-BD(58)*TANAI
      BD(761)=STG(134)*AHT(10)
      BD(64)=BD(762)-BD(761)*SINAI-ZCG
      BD(63)=BD(84)-BD(761)*COSAI
      ICDWB=0
      IP=0
      IQ=0
      DO 1190 J=1,NALPHA
         CALL TBFUNX(FLC(J+22),YARG,CDAWB(J) ,NALPHA,FLC(23),BW(1),
     1               CCDWB,ICDWB,MI,NG,0,0,4HYARG,1,ROUTID)
         ALPAHT=FLC(J+22)-EPSLON(J)+ALIH
         ALPAT=(STG(J+32)*RAD-EPSLON(J))/RAD
         IF(CANARD) ALPAT=STG(J+32)
         CALL TBFUNX(ALPAT,CLH(J),DYDX,NALPHA,STG(33),HT(21),
     1               CAA,IP,MI,NG,0,0,4HCLH ,1,ROUTID)
         CALL TBFUNX(ALPAT,CLAHA(J),DYDX,NALPHA,STG(33),HT(101),
     1               CB,IQ,MI,NG,0,0,4HCLHA,1,ROUTID)
         DETCL=ARG3*ALPAHT   *IVBH(J)*GAMMA(J)*QOQINF(J)
         DCLOAL = ARG3*IVBH(J)*GAMMA(J)*QOQINF(J)
 1140    ALPA=FLC(J+22)-EPSLON(J)
         CLTB(J)=(ARG2+(CLH(J)-CLI)*ARG1)*QOQINF(J)*((MACH**2-1.0)/(
     1           HMACH(J)**2-1.0))**0.50
         IF(.NOT. CANARD) GO TO 1150
         CLWBT(J)=CLWB(J)+CLTB(J)+DETCL+DELTAT(J)*FLC(J+22)
         FACT(J+101)=0.0
         IF(ALPAHT .EQ. 0.0) GO TO 1160
         FACT(J+101)=(DCLOAL*EPSLON(J+20)
     1               -DELTAT(J)*FLC(J+22))/(DCLOAL
     2               +CLAHA(J)*ARG1*QOQINF(J)*((MACH**2-1.0)/(HMACH(J)
     3                **2-1.0))**0.5)
         GO TO 1160
 1150    CONTINUE
         CLWBT(J)=CLWB(J)+CLTB(J)+DETCL
 1160    CONTINUE
C
C     ********* CALCULATE (CM)ALPHA WBT **********
C
         IF(CANARD) ALPA=FLC(J+22)
         SA=SIN(ALPA/RAD)
         CA=COS(ALPA/RAD)
         DXACWB=CMAWB/CLAWB
         APART=(DXACWB)*((-CLWB(J)/RAD+CDAWB(J))*SIN(FLC(J+22)/RAD)+
     1         (CLAWB+CDWB(J)/RAD)*COS(FLC(J+22)/RAD))
         ZAC=BD(68)-ZCG    -BD(78)*SLG(134)*A(10)
         BPART=((ZAC)/CBARR)*((CLAWB+CDWB(J)/RAD)*SIN(FLC(J+22)
     1         /RAD)+(CLWB(J)/RAD-CDAWB(J))*COS(FLC(J+22)/RAD))
         IK=0
         CALL TBFUNX(ALPAT,CDHT,DCDDA,NALPHA,STG(33),HT(1),CC,IK,MI,NG,
     1               0,0,4HCDHT,1,ROUTID)
         CLHT=(CLWBT(J)-CLWB(J))/QOQINF(J)
         DCLDA=CLAHB+CLABH
         IF(.NOT. CANARD) GO TO 1170
         DCLDA=DCLDA+DELTAT(J)/QOQINF(J)
 1170 CONTINUE
      CPART=(-CLHT+DCDDA)*SA/RAD
      DPART=( CLHT-DCDDA)*CA/RAD
      EPART=QOQINF(J)*(1.0-DEDALP(J))
      FPART=(DCLDA+CDHT/RAD)*SA
      GPART=(DCLDA+CDHT/RAD)*CA
      CMAH(J)=(BD(63)/CBARR)*(CPART+GPART)*EPART-(BD(64)/
     1         CBARR)*(FPART+DPART)*EPART
      IF(.NOT. CANARD) GO TO 1180
      CMAH(J)=CMAH(J)/(1.0-DEDALP(J))
 1180 CMAWBT(J)=APART-BPART+CMAH(J)
C
C     COMPUTE WING-BODY-TAIL PITCHING MOMENT INCLUDING INCIDENCE EFFECTS
C
      CMWBT(J)=CMAWBT(J)*FLC(J+22)+(SLG(136)/RAD)*(SWB(2)+SWB(37))*ALIW
     1         +(STG(136)/RAD)*(STP(131)+STP(132))*ALIH*QOQINF(J)
C
C     ********* CALCULATE (CD)WBT ***********
C
      CD0WBT=CD0WB+CD0H
      CD0WBV=CD0WBT+CD0V+CD0VF
      CDWBT(J)=CDWB(J)+(CDHT   *COS(EPSLON(J)/RAD)+CLH(J)*
     1         SIN(EPSLON(J)/RAD))*QOQINF(J)
      CDWBTV(J)=CDWBT(J)+CD0V+CD0VF
 1190 CONTINUE
C
C     *********CN(J) AND CA(J)*********
C
      DO 1200 J=1,NALPHA
         BWHV(J+120) = CMAWBT(J)
         BWHV(J+100) = CLAWBT(J)
         COSA=COS(FLC(J+22)/RAD)
         SINA=SIN(FLC(J+22)/RAD)
         CNWBT(J)=CLWBT(J)*COSA+CDWBT(J)*SINA
         CAWBT(J)=CDWBT(J)*COSA-CLWBT(J)*SINA
         BWHV(J+20) = CLWBT(J)
         BWHV(J+40)=CMWBT(J)
         CNWBTV(J)=CLWBT(J)*COSA+CDWBTV(J)*SINA
 1200 CAWBTV(J)=CDWBTV(J)*COSA-CLWBT(J)*SINA
      IF(TANLE .EQ. 0.00001)TANLE=0.0
      RETURN
      END

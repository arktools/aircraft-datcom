      SUBROUTINE TRANJT
C
C***  HYPERSONIC TRANSVERSE JET SIZING CALCULATIONS
C
      COMMON /OVERLY/ NLOG,NMACH,IM,NALPHA
      COMMON /CONSNT/ PI,DR,UNUSED,RAD
      COMMON /FLGTCD/ FLC(93)
      COMMON /IBODY/  PBODY,JET(200)
      COMMON /SUPDW/  JETA(26)
      COMMON /FLAPIN/ F(48)
      REAL ME,ISP,L,M1(10),K(10),K0(10),MACH,JET,JETA
      LOGICAL LAMNR(10)
      DIMENSION ROUTID(2)
      DIMENSION RS(10),HL(10),HLN(10),XCP(10)
      DIMENSION X1235A(3),X2235A(13),Y3235A(39),Q3235A(3)
      DIMENSION X1235B(5),Y3235B(65),Q3235B(3)
      DIMENSION X1235C(6),X2235C(13),Y3235C(78),Q3235C(3)
      DIMENSION X1235D(6),X2235D(12),Y3235D(72),Q3235D(3)
      DIMENSION X1235E(5),X2235E(12),Q3235E(3),Y3235E(60)
      DIMENSION X13243(4),X23243(6),Y63243(24),Q63243(2)
      DIMENSION X13230(  6),X23230( 11),Y63230(  66),Q63230(3)
      DIMENSION X13231(  5),X23231( 11),Y63231(  55),Q63231(3)
      DIMENSION X13232(  6),X23232( 11),Y63232(  66),Q63232(3)
      DIMENSION X13233(  6),X23233( 15),Y63233(  90),Q63233(3)
      DIMENSION X13240(6),X23240(10),Y63240(60),Q63240(2)
      DIMENSION ALPHA(10),P1PI(10),Q1QI(10),R1RI(10),P1(10),Q1(10),
     1RL(10),CFC(10),CFCR(10),FJ0(10),FC(10),PJ0P1M(10),P0J(10),
     2P0JT(10),RATE(10),TIME(10),WEIGHT(10)
C
C   JET ARRAY CORRESPONDS TO BODY ARRAY ELSEWHERE
C
      EQUIVALENCE (M1(1),JET(1)),(RL(1),JET(11)),(P1(1),JET(21)),(Q1(1),
     1JET(31)),(CFC(1),JET(41)),(CFCR(1),JET(51)),(K0(1),JET(61)),
     2(K(1),JET(71)),(FJ0(1),JET(81)),(PJ0P1M(1),JET(91)),(P0J(1),JET
     3(101)),(P0JT(1),JET(111)),(RATE(1),JET(121)),(XCP(1),JET(138))
      EQUIVALENCE (WEIGHT(1),JET(131)),(QINF,JETA(1)),(CF0,JETA(2)),
     1(VEOA,JETA(3)),(FJMAX,JETA(4)),(PJMAX,JETA(5)),(DT,JETA(6))
      EQUIVALENCE (FC(1),F(12)),(ME,F(32)),(ALPHA(1),F(22)),
     1(ISP,F(33)),(SPAN,F(34)),(PHE,F(35)),(GP,F(36)),(CC,F(37)),
     2(L,F(38)),(LAMNR(1),F(39)) ,(TIME(1),F(1))
      DATA ROUTID/4HTRAN,4HJT  /
C
C      ----FIGURE 63230
C
      DATA Q63230/4H6323,4H0   ,4H    /
      DATA X13230/  .300E 02,  .200E 02,  .150E 02,  .100E 02,
     1  .700E 01,  .500E 01/
      DATA X23230/  .907E-01,  .206E 01,  .404E 01,  .404E 01,
     1  .598E 01,  .800E 01,  .100E 02,  .121E 02,  .140E 02,  .160E 02,
     2  .180E 02/
      DATA Y63230/  .141E 01,  .445E 01,  .983E 01,  .983E 01,
     1  .187E 02,  .321E 02,  .477E 02,  .671E 02,  .894E 02,  .116E 03,
     2  .148E 03,  .139E 01,  .272E 01,  .524E 01,  .524E 01,  .954E 01,
     3  .154E 02,  .226E 02,  .319E 02,  .424E 02,  .542E 02,  .667E 02,
     4  .137E 01,  .185E 01,  .407E 01,  .407E 01,  .608E 01,  .918E 01,
     5  .136E 02,  .186E 02,  .246E 02,  .314E 02,  .384E 02,  .138E 01,
     6  .163E 01,  .258E 01,  .258E 01,  .406E 01,  .526E 01,  .728E 01,
     7  .989E 01,  .121E 02,  .150E 02,  .184E 02,  .138E 01,  .163E 01,
     8  .191E 01,  .191E 01,  .298E 01,  .395E 01,  .465E 01,  .598E 01,
     9  .732E 01,  .865E 01,  .105E 02,  .137E 01,  .141E 01,  .146E 01,
     A  .146E 01,  .195E 01,  .330E 01,  .354E 01,  .402E 01,  .471E 01,
     B  .540E 01,  .633E 01/
C
C      ----FIGURE 63231
C
      DATA Q63231/4H6323,4H1   ,4H    /
      DATA X13231/  .200E 02,  .150E 02,  .100E 02,  .700E 01,
     1  .500E 01/
      DATA X23231/  .184E-01,  .199E 01,  .402E 01,  .599E 01,
     1  .794E 01,  .993E 01,  .119E 02,  .139E 02,  .160E 02,  .179E 02,
     2  .199E 02/
      DATA Y63231/  .101E 01,  .187E 01,  .285E 01,  .369E 01,
     1  .420E 01,  .455E 01,  .475E 01,  .482E 01,  .481E 01,  .477E 01,
     2  .463E 01,  .996E 00,  .166E 01,  .236E 01,  .305E 01,  .359E 01,
     3  .398E 01,  .427E 01,  .443E 01,  .448E 01,  .447E 01,  .443E 01,
     4  .101E 01,  .137E 01,  .185E 01,  .231E 01,  .271E 01,  .309E 01,
     5  .342E 01,  .366E 01,  .380E 01,  .388E 01,  .389E 01,  .100E 01,
     6  .124E 01,  .153E 01,  .184E 01,  .215E 01,  .243E 01,  .270E 01,
     7  .290E 01,  .307E 01,  .318E 01,  .323E 01,  .101E 01,  .115E 01,
     8  .135E 01,  .153E 01,  .175E 01,  .194E 01,  .212E 01,  .229E 01,
     9  .240E 01,  .249E 01,  .256E 01/
C
C      ----FIGURE 63232
C
      DATA Q63232/4H6323,4H2   ,4H    /
      DATA X13232/  .300E 02,  .200E 02,  .150E 02,  .100E 02,
     1  .700E 01,  .500E 01/
      DATA X23232/  .264E-02,  .204E 01,  .400E 01,  .602E 01,
     1  .803E 01,  .100E 02,  .120E 02,  .140E 02,  .160E 02,  .180E 02,
     2  .200E 02/
      DATA Y63232/  .300E 02,  .241E 02,  .191E 02,  .149E 02,
     1  .119E 02,  .976E 01,  .828E 01,  .715E 01,  .615E 01,  .550E 01,
     2  .484E 01,  .200E 02,  .171E 02,  .145E 02,  .124E 02,  .105E 02,
     3  .886E 01,  .771E 01,  .662E 01,  .593E 01,  .528E 01,  .480E 01,
     4  .151E 02,  .135E 02,  .121E 02,  .108E 02,  .945E 01,  .837E 01,
     5  .727E 01,  .650E 01,  .575E 01,  .506E 01,  .454E 01,  .101E 02,
     6  .934E 01,  .869E 01,  .800E 01,  .731E 01,  .667E 01,  .614E 01,
     7  .567E 01,  .510E 01,  .466E 01,  .432E 01,  .695E 01,  .669E 01,
     8  .625E 01,  .596E 01,  .570E 01,  .522E 01,  .493E 01,  .448E 01,
     9  .422E 01,  .375E 01,  .345E 01,  .503E 01,  .481E 01,  .464E 01,
     A  .447E 01,  .421E 01,  .391E 01,  .374E 01,  .361E 01,  .335E 01,
     B  .309E 01,  .292E 01/
C
C      ----FIGURE 63233
C
      DATA Q63233/4H6323,4H3   ,4H    /
      DATA X13233/  .300E 02,  .200E 02,  .150E 02,  .100E 02,
     1  .700E 01,  .500E 01/
      DATA X23233/ -.475E-01,  .196E 01,  .291E 01,  .345E 01,
     1  .402E 01,  .535E 01,  .606E 01,  .628E 01,  .806E 01,  .101E 02,
     2  .120E 02,  .140E 02,  .160E 02,  .180E 02,  .200E 02/
      DATA Y63233/  .101E 01,  .180E 01,  .196E 01,  .198E 01,
     1  .197E 01,  .187E 01,  .177E 01,  .172E 01,  .147E 01,  .120E 01,
     2  .101E 01,  .840E 00,  .710E 00,  .610E 00,  .530E 00,  .101E 01,
     3  .157E 01,  .177E 01,  .185E 01,  .191E 01,  .199E 01,  .199E 01,
     4  .198E 01,  .184E 01,  .164E 01,  .145E 01,  .126E 01,  .109E 01,
     5  .949E 00,  .842E 00,  .101E 01,  .143E 01,  .162E 01,  .172E 01,
     6  .178E 01,  .191E 01,  .196E 01,  .197E 01,  .196E 01,  .185E 01,
     7  .172E 01,  .156E 01,  .141E 01,  .127E 01,  .113E 01,  .101E 01,
     8  .129E 01,  .141E 01,  .148E 01,  .153E 01,  .169E 01,  .176E 01,
     9  .177E 01,  .189E 01,  .193E 01,  .191E 01,  .184E 01,  .176E 01,
     A  .166E 01,  .154E 01,  .101E 01,  .122E 01,  .130E 01,  .135E 01,
     B  .140E 01,  .150E 01,  .156E 01,  .157E 01,  .169E 01,  .180E 01,
     C  .185E 01,  .188E 01,  .185E 01,  .182E 01,  .175E 01,  .101E 01,
     D  .115E 01,  .122E 01,  .126E 01,  .129E 01,  .136E 01,  .141E 01,
     E  .142E 01,  .152E 01,  .162E 01,  .168E 01,  .174E 01,  .176E 01,
     F  .176E 01,  .175E 01/
C
C              FIGURE 6.3.2-35A
C
      DATA X1235A/20.,10.,4./
      DATA X2235A/4E-3,1E-2,2E-2,4E-2,6E-2,8E-2,1E-1,2E-1,4E-1,8E-1,
     11.,2.,6./
      DATA Y3235A/
     13.4,3.3,3.19,2.94,2.67,2.45,2.30,1.98,1.74,1.56,1.50,1.36,1.21,
     23.17,3.10,3.00,2.84,2.68,2.50,2.37,2.02,1.72,1.56,1.51,1.36,1.21,
     32.95,2.94,2.90,2.80,2.69,2.60,2.52,2.19,1.85,1.58,1.50,1.36,1.21/
      DATA Q3235A/4H6.3.,4H2-35,4HA   /
C
C              FIGURE 6.3.2-35B
C
      DATA X1235B/20.,10.,6.,4.,2./
      DATA Y3235B/
     14.10,4.01,3.68,3.05,2.69,2.47,2.32,2.00,1.75,1.56,1.50,1.32,1.20,
     24.00,3.88,3.63,3.19,2.81,2.58,2.40,2.04,1.78,1.57,1.50,1.32,1.20,
     33.84,3.80,3.61,3.22,2.92,2.69,2.50,2.11,1.80,1.60,1.52,1.32,1.20,
     43.67,3.61,3.50,3.30,3.09,2.89,2.70,2.20,1.85,1.60,1.52,1.32,1.20,
     53.23,3.20,3.14,3.04,2.96,2.88,2.80,2.41,2.03,1.73,1.68,1.41,1.20/
      DATA Q3235B/4H6.3 ,4H2-35,4HB   /
C
C              FIGURE 6.3.2-35C
C
      DATA X1235C/20.,15.,10.,6.,4.,2./
      DATA X2235C/4E-4,1E-3,4E-3,6E-3,8E-3,1E-2,2E-2,4E-2,6E-2,1E-1,
     12E-1,4E-1,8E-1/
      DATA Y3235C/
     15.68,5.61,5.32,5.12,4.93,4.72,3.80,3.00,2.67,2.32,2.00,1.77,1.59,
     25.50,5.49,5.20,5.04,4.88,4.72,3.95,3.10,2.67,2.37,2.00,1.77,1.59,
     35.36,5.31,5.10,4.96,4.71,4.68,4.00,3.19,3.79,2.40,2.00,1.77,1.59,
     44.94,4.93,4.82,4.78,4.70,4.60,4.14,3.41,2.98,2.55,2.12,1.82,1.60,
     54.50,4.46,4.40,4.38,4.32,4.28,4.00,3.53,3.15,2.65,2.18,1.82,1.60,
     63.60,3.60,3.59,3.58,3.55,3.53,3.48,3.34,3.20,2.88,2.36,2.00,1.72/
      DATA Q3235C/4H6.3.,4H2-35,4HC   /
C
C              FIGURE 6.3.2-35D
C
      DATA X1235D/20.,15.,10.,6.,4.,2./
      DATA X2235D/4E-4,1E-3,4E-3,6E-3,8E-3,1E-2,2E-2,4E-2,6E-2,1E-1,
     14E-1,8E-1/
      DATA Y3235D/
     17.55,7.40,6.60,6.10,5.60,5.20,3.89,3.12,2.75,2.40,1.77,1.57,
     27.33,7.20,6.49,6.05,5.65,5.30,4.00,3.15,2.75,2.40,1.77,1.57,
     36.89,6.84,6.38,6.01,5.70,5.40,4.18,3.26,2.83,2.48,1.77,1.57,
     46.02,6.02,5.80,5.60,5.43,5.29,4.39,3.40,2.99,2.60,1.90,1.70,
     55.20,5.19,5.03,4.99,4.90,4.80,4.38,3.60,3.09,2.60,1.90,1.70,
     63.81,3.83,3.80,3.78,3.73,3.70,3.60,3.48,3.30,2.90,2.00,1.70/
      DATA Q3235D/4H6.3.,4H2-35,4HD   /
C
C              FIGURE 6.3.2-35E
C
      DATA X2235E/4E-4,1E-3,2E-3,4E-3,6E-3,8E-3,1E-2,2E-2,4E-2,1E-1,
     12E-1,8E-1/
      DATA X1235E/20.,15.,10.,6.,4./
      DATA Y3235E/
     110.0,9.52,8.80,7.45,6.39,5.60,5.10,3.88,3.02,2.37,1.99,1.50,
     21.60,9.29,8.70,7.60,6.60,5.80,5.20,3.95,3.04,2.37,1.99,1.52,
     38.73,8.58,8.20,7.50,6.90,6.26,5.62,4.13,3.21,2.41,2.01,1.54,
     47.12,7.00,6.90,6.60,6.32,6.00,5.70,4.47,3.40,2.58,2.10,1.56,
     55.72,5.71,5.67,5.60,5.48,5.34,5.20,4.52,3.57,2.62,2.20,1.59/
      DATA Q3235E/4H6.3.,4H2-35,4HE   /
C
C              FIGURE 6.3.2-43
C
      DATA X13243/1.0,1.5,1.75,2.0/
      DATA X23243/2.,4.,6.,8.,10.,12./
      DATA Y63243/
     17.50,11.4,15.3,18.9,22.6,26.3,
     221.2,31.2,41.8,52.0,63.1,74.0,
     350.0,73.1,97.0,121.0,148.0,171.0,
     4192.,282.,376.,477.,573.,650./
      DATA Q63243/4H6.3.,4H2-43/
C
C              FIGURE 6.3.2-40  K0 FOR TURBULENT B.L.
C
      DATA X13240/20.,15.,10.,6.,4.,2./
      DATA X23240/4E-5,1E-4,2E-4,4E-4,2E-3,6E-3,1E-2,2E-2,4E-2,0.1/
      DATA Y63240/
     13.08,2.92,2.78,2.62,2.21,1.92,1.80,1.65,1.49,1.28,
     23.02,2.96,2.88,2.76,2.40,2.11,1.98,1.80,1.63,1.40,
     32.95,2.94,2.90,2.85,2.63,2.37,2.23,2.05,1.87,1.64,
     42.75,2.75,2.75,2.75,2.70,2.58,2.48,2.33,2.17,1.80,
     52.50,2.50,2.52,2.54,2.55,2.53,2.49,2.41,2.29,2.04,
     62.23,2.23,2.22,2.21,2.21,2.21,2.20,2.20,2.20,2.20/
      DATA Q63240/4H6.3.,4H2-40/
C
      MACH=FLC(IM+2)
      RLN=FLC(IM+42)
      PINF=FLC(IM+73)
      NT=F(11)+.5
      QINF=0.7*PINF*MACH**2
      ARG=GP+1.
      ARG1=GP/(GP-1.)
      CF0= (2./ARG)**ARG1*ARG
      DO 1020 J=1,NT
C
C              FIGURE 6.3.2-30
C
         CALL TLINEX(X13230,X23230,Y63230,6,11,MACH,ALPHA(J),P1PI(J),
     1               0,0,0,1,Q63230,3,ROUTID)
C
C              FIGURE 6.3.2-31
C
         CALL TLINEX(X13231,X23231,Y63231,5,11,MACH,ALPHA(J),Q1QI(J),
     1               0,0,0,0,Q63231,3,ROUTID)
C
C              FIGURE 6.3.2-32
C
         CALL TLINEX(X13232,X23232,Y63232,6,11,MACH,ALPHA(J),M1(J),
     1               0,0,0,0,Q63232,3,ROUTID)
C
C              FIGURE 6.3.2-33
C
         CALL TLINEX(X13233,X23233,Y63233,6,15,MACH,ALPHA(J),R1RI(J),
     1               0,0,0,0,Q63233,3,ROUTID)
         P1(J)=P1PI(J)*PINF
         Q1(J)=Q1QI(J)*QINF
         RL(J)=R1RI(J)*RLN*L
         CFC(J)=FC(J)/(Q1(J)*SPAN*L*144.)
         CFCR(J)=1.268*CFC(J)/CF0
         IF(LAMNR(J))GO TO 1000
C
C    ----HERE FOR TURBULENT B.L.
C              FIGURE 6.3.2-40  K0
C
         CALL TLINEX(X13240,X23240,Y63240,6,10,M1(J),CFCR(J),K0(J),
     1               0,0,0,0,Q63240,2,ROUTID)
         GO TO 1010
C
C    ----HERE FOR LAMINAR B.L.
C              FIGURE 6.3.2-35 A-E  K0
C
 1000    CALL INTER3(M1(J),CFCR(J),RL(J),X1235A,X2235A,Y3235A,3,13,
     1               Q3235A,X1235B,X2235A,Y3235B,5,13,Q3235B,
     2               X1235C,X2235C,Y3235C,6,13,Q3235C,
     3               X1235D,X2235D,Y3235D,6,12,Q3235D,
     4               X1235E,X2235E,Y3235E,5,12,Q3235E,K0(J))
 1010    CONTINUE
         ARG1=ARG*ME**2
         ARG2=2.+(GP-1.)*ME**2
         VEOA=(ARG1/ARG2)
         VEOA=SQRT(VEOA)
         PH=PHE/RAD
         ARG1=1.+GP*VEOA*SIN(PH)/ARG
         ARG2=(VEOA+1./VEOA)*COS(PH)/2.
         K(J)=(K0(J)-1.)*ARG1+ARG2
         FJ0(J)=FC(J)/K(J)
C
C              FIGURE 6.3.2-43
C
         CALL TLINEX(X13243,X23243,Y63243,4,6,VEOA,M1(J),PJ0P1M(J),
     1               0,0,0,0,Q63243,2,ROUTID)
         P0J(J)=PJ0P1M(J)*P1(J)
 1020 CONTINUE
C
C    ----GET MAXIMUM FJ0 AND P0J
C
      FJMAX=FJ0(1)
      PJMAX=P0J(1)
      DO 1030 J=1,NT
         IF(FJ0(J).GT.FJMAX)FJMAX=FJ0(J)
         IF(P0J(J).GT.PJMAX)PJMAX=P0J(J)
 1030 CONTINUE
      ARG=CC*CF0*SPAN*12.0
      DT=FJMAX/(ARG*PJMAX)
      DO 1040 J=1,NT
         P0JT(J)=FJ0(J)/(ARG*DT)
 1040 RATE(J)=FJ0(J)/ISP
      CALL TRAPZ(RATE,NT,TIME,WEIGHT,0)
C
C    ----LOCATE CONSERVATIVE XCP
C
      DO 1090 J=1,NT
         R2=M1(J)**2
         IF(.NOT.LAMNR(J))GO TO 1080
C
C    ----HERE FOR LAMINAR B.L.
C
         RS(1)=.2*RL(J)
         DO 1050 I=2,10
 1050     RS(I)=.75*RS(I-1)
         NZ=10
         DO 1060 I=1,5
            SAVE=RS(I)
            RS(I)=RS(NZ)
            RS(NZ)=SAVE
 1060    NZ=NZ-1
         ARG=2.*CF0*DT/(L*12.)
         ARG3=ARG*P0JT(J)/P1(J)
         DO 1070 I=1,10
            ARG=RS(I)*(R2-1.)
            CP2=1.60/ARG**0.25
            CX=4.75*CP2
            HL(I)=ARG3/(GP*CX*R2+2.)
            P2=CP2*Q1(J)+P1(J)
            ZI=P2/P1(J)
            ARG1=5.*(ZI-1.)/(7.*R2-5.*(ZI-1.))
            ARG=(7.*R2-(6.*ZI+1.))/(6.*ZI+1.)
            ARG=SQRT(ARG)
            TANSIG=ARG1*ARG
            HLN(I)=(1.-RS(I)/RL(J))*TANSIG
 1070    CONTINUE
         CALL SIMUL2(RS,HL,HLN,10,RLS,HOL)
         IF(RLS.EQ.(-1000.))RLS=RS(10)
         ARG=(RLS*(R2-1.))**0.25
         CP2=1.60/ARG
         G=1.-1./K(J)
         ARG=1.-G/2.*CFC(J)/CP2
         XCP(J)=(1.-G)+G*ARG
         GO TO 1090
 1080    CONTINUE
C
C    ----HERE FOR TURB. B.L.
C
         IF(M1(J).GT.5.0)
     1            CP2=0.2257-0.0232*M1(J)+0.0014*R2-0.00003*R2*M1(J)
         IF(M1(J).LE.5.0)
     1            CP2=0.41+0.481*M1(J)-0.0509*R2+0.0061*R2*M1(J)
         G=1.-1./K(J)
         ARG=1.-G/2.*CFC(J)/CP2
         XCP(J)=(1.-G)+G*ARG
 1090 CONTINUE
      DO 1100 J=1,10
 1100 JETA(J+16) = JET(J+70)
      RETURN
      END

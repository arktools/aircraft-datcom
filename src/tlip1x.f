      SUBROUTINE TLIP1X(X1,Y,NP1,XA1,YA,LX1L,LX1U,MESS,NMSS,ROUT)
C
C***  LINEAR INTERPOLATION FOR A PACKED TABLE Y=F(X)
C
C AJT DIMENSION Y(2),X1(2),DA(3),MESS(20),ROUT(2),NP1(7)
      DIMENSION Y(*),X1(*),DA(3),MESS(*),ROUT(*),NP1(*)      
      DIMENSION MSSCL(9),RMSCL(9)
      EQUIVALENCE (RMSCL(1),MSSCL(1))
      LOGICAL NOIN1,NAS1,X1A,X1B,MSSG1,EX1,LG(7)
      EQUIVALENCE (NOIN1,LG(1)),(X1A,LG(2)),(X1B,LG(3)),(MSSG1,LG(4)),
     1      (EX1,LG(5)),(DA(1),D0),(DA(2),D1),(DA(3),D2),(NAS1,LG(6))
      DATA TLIN /4H1TIN/, HOL1 /4H1EXP/
      DATA MSSCL /4HTLIP,4H1X  ,2*0,1,4*0/
C
      NX1=IABS(NP1(1))
      CALL SWITCH(LG,LX1L,LX1U,XA1,X1,NX1)
      IF(LG(7))GO TO 1030
      CALL GLOOK(NX1,XA1,X1,NAS1,NOIN1,I1,T1)
      YI1=YUP(I1,NP1,Y)
      D2=YI1
      IF(NOIN1)GO TO 1000
      YI1M1=YUP(I1-1,NP1,Y)
      D2=YI1M1+T1*(D2-YI1M1)
 1000 YA=D2
      IF(MSSG1)GO TO 1010
      RETURN
 1010 IF(ROUT(1).NE.TLIN)GO TO 1020
      ROUT(1)=HOL1
      RETURN
C
C     ----PRINT EXTRAPOLATION MESSAGE
C
 1020 MSSCL(3)=NMSS
      RMSCL(4)=YA
      RMSCL(6)=XA1
      MSSCL(7)=NX1
      MSSCL(8)=LX1L
      MSSCL(9)=LX1U
      CALL MESSGE(ROUT,MESS,X1,LG,LG,LG,MSSCL)
      RETURN
C
C     ----HERE FOR EXTRAPOLATION
C
 1030 IF(X1B)GO TO 1060
C
C     ----HERE FOR XA1 ABOVE
C
      YNX1=YUP(NX1,NP1,Y)
      YNX1M1=YUP(NX1-1,NP1,Y)
      IF(LX1U.GT.1.AND.NX1.GT.2)GO TO 1040
C
C     ----LINEAR EXTRAPOLATION
C
      T1=(XA1-X1(NX1))/(X1(NX1)-X1(NX1-1))
      YA=YNX1+T1*(YNX1-YNX1M1)
      GO TO 1010
C
C     ----QUADRATIC EXTRAPOLATION
C
 1040 D2=YNX1
      D1=YNX1M1
      IX=NX1-2
      D0=YUP(IX,NP1,Y)
 1050 CALL QUAD(X1(IX),DA,XA1,YA)
      GO TO 1010
C
C     ----HERE FOR XA1 BELOW
C
 1060 Y1=YUP(1,NP1,Y)
      Y2=YUP(2,NP1,Y)
      IF(LX1L.GT.1.AND.NX1.GT.2)GO TO 1070
C
C     ----LINEAR EXTRAPOLATION
C
      T1=(XA1-X1(1))/(X1(2)-X1(1))
      YA=Y1+T1*(Y2-Y1)
      GO TO 1010
 1070 D0=Y1
      D1=Y2
      D2=YUP(3,NP1,Y)
      IX=1
      GO TO 1050
      END

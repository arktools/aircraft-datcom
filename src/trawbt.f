      SUBROUTINE TRAWBT(KDEODA,KQOQIN)
C
C ******COMPUTES TRANSONIC WING-BODY-TAIL DOWNWASH,
C       DYNAMIC PRESSURE RATIO AND LIFT CURVE SLOPE
C
      COMMON /OVERLY/ NLOG,NMACH,NZ,NALPHA
      COMMON /FLGTCD/ FLC(93)
      COMMON /CONSNT/ PI,DR,UNUSED,RAD
      COMMON /SYNTSS/ SYNA(19)
      COMMON /WINGD/  A(195), B(49)
      COMMON /HTDATA/ AHT(195)
      COMMON /SBETA/  STB(135),TRA(108),TRAH(108)
      COMMON /HTI/    HTIN(131)
      COMMON /OPTION/ SREF,CBARR,RUFF,BLREF
      COMMON /WINGI/  WINGIN(77)
      COMMON /IDWASH/ PDWASH, DWASH(60)
      COMMON /IWING/  PWING, WING(400)
      COMMON /BDATA/  BD(762)
      COMMON /IBWH/   PBWH, BWH(380)
      COMMON /IBWHV/  PBWHV, BWHV(380)
      COMMON /IBW/    PBW, BW(380)
      COMMON /IHT/    PHT,HT(380)
      REAL K,MACH,MFB
      REAL MFB0
      DIMENSION ROUTID(2)
      DIMENSION           Q44155(2),Q44156(2),Q4157B(3)
      DIMENSION X155B1(3),X155B2(2),Y4155B(6)
      DIMENSION X156B2(9),X156B1(4),Y4156B(9,4)
      DIMENSION X156A2(13),X156A1(6),Y156A(13,6)
      DIMENSION X157B2(14),X157B1(4),Y4157B(14,4)
C
C     ----FIGURE 4.4.1-55 (A,B,C)
C
      DIMENSION X155A2(4),X155A1(4),Y4155A(16)
      DIMENSION X155C2(7),X155C1(2),Y4155C(14)
      DIMENSION Q34171(4),
     1    Q34172(4),Q3418A(3),Q34181(3),Q34182(3),Q3419B(3),Q3419C(3),
     2    Q3419A(3),Q15127(4),Q5129R(3),Q5129L(3),Q23124(3),Q23126(3)
      DIMENSION WTYPE(4),VAR(4),LGH(4)
      EQUIVALENCE (DEODA,DWASH(41))
      EQUIVALENCE (CDOH,TRAH(108))
      EQUIVALENCE (TRAH(72),CLABW), (TRAH(71),CLAWB)
      EQUIVALENCE (SWA4,SAC4)
      EQUIVALENCE (RL2,A(24)),(CBAR,A(16)),(CD0,WING(1)),(GAMMA,A(11))
      EQUIVALENCE (DQOQ,TRA(69)),(ZWC,TRA(2)),(ZC,TRA(11))
     1,(QOQINF,DWASH(1)),(CLA,TRA(73))
     2,(CLAWBT,BWHV(101)),(DJ,TRA(26))
      EQUIVALENCE (CLAM,WING(101)),(CLALS,B(48)),(HH,A(12))
     1,(ALIW,SYNA(4)),(ALCLM,A(127)),(ALP0,A(126))
      EQUIVALENCE (CLAWGB,BW(101))
      EQUIVALENCE (TOC,HTIN(16)),(ARSTAR,AHT(7)),(SWEPE2,AHT(71))
     1,(TANC2,AHT(74)),(SR,SREF),(SRSTAR,AHT(3)),(CLAMO,HTIN(69))
      EQUIVALENCE (SPAN,HTIN(4)),(SPANS,HTIN(3))
      DATA WTYPE / 4HSTRA, 4HDOUB, 4HCRAN, 4HCURV /
      DATA ROUTID/4HTRAW,4HBT  /
      DATA                              Q44155/4H4.4.,4H1-66/
     1, Q44156/4H4.4.,4H1-67/,Q4157B/4H4.4.,4H1-68,4HB   /
C
C     ----FIGURE 4.4.1-68B AVERAGE DOWNWASH ACTING ON AFT LIFTING
C     ----SURFACE-LOW SPEEDS
C
      DATA X157B1 /.0,.2,.6,1./
      DATA X157B2 /.2,.3,.4,.5,.6,.7,.8,.833,1.,1.1 ,1.2,1.3,1.4,1.5/
      DATA Y4157B /1.,1.03,1.068,1.11,1.176,1.26,1.36,1.34,1.20,1.11,1.0
     1,.88,.74,.6  , .96,.96,.965,.976,.98,1.016,1.036,1.04,.946,.88,.8,
     2.69,.58,.46  , .74,.73,.72,.71,.69,.67,.644,.638,.582,.56,.52,.48,
     3.44,.4  ,   .5,.5,.5,.49,.476,.46,.448,.44,.4,.372,.352,.32,.3,.27
     4 /
      DATA X155A2 /.4,.55,.725,1./
      DATA X155A1/60.,45.,30.,0./
      DATA Y4155A/5.,4.,3.,1.25,2*5.,4.2,2.75,3*5.,4.,4*5./
      DATA X155C2/.41,.5,.58,.66,.75,.9,1./
      DATA X155C1/0.,1./
      DATA Y4155C /.56,.66,.725,.8,.86,.94,.99 , 3*.58,.675,.74,.9,.99/
      DATA X155B1 /0.,.5,1./
      DATA X155B2 /5.,.3/
      DATA Y4155B /1.,.3 , 1.,.425 , 1.,.525 /
      DATA X156B1/0.,30.,45.,60./
      DATA X156B2/1.,1.5,2.,2.5,3.,4.,6.,8.,10./
      DATA Y4156B /1.25,.92,.8,.72,.64,.52,.4,.33,.3  , 1.0,.88,.76,.68,
     1.60,.49,.36,.296,.26  ,  .9,.76,.66,.572,.52,.432,.32,.252,.2  ,
     2  .8,.64,.52,.464,.4,.33,.24,.18,.16 /
      DATA X156A1/1.5,2.,3.,5.,7.,10./
      DATA X156A2/.2,.3,.4,.5,.6,.7,.8,.9,1.0,1.2,1.4,1.8,2.2/
      DATA Y156A/3.4,2.88,2.45,2.1,1.8,1.6,1.4,1.28,1.12,.9,.76,.58,
     1.45 , 3.2,2.8,2.35,1.93,1.65,1.46,1.26,1.12,1.0,.8,.64,.46,.35 ,
     2 2.75,2.33,1.95,1.6,1.34,1.2,1.0,.88,.75,.6,.47,.32,.26,
     3 2.25,1.85,1.46,1.2,.98,.8,.7,.6,.55,.4,.35,.25,.2 ,
     4 1.95,1.54,1.23,1.0,.8,.68,.58,.5,.42,.33,.26,.18,.18,
     5 1.55,1.2,.9,.74,.6,.5,.4,.35,.3,.22,.18,.1,.1 /
C
C  *** HORIZONTAL TAIL ALONE ***
C
      IF(HTIN(15).NE.WTYPE(1))RETURN
      IF(WINGIN(4).LT.1.5*HTIN(4))RETURN
C
C  ***TRANSONIC WING BODY TAIL DOWNWASH ANGLE***
C
      ARG1=ALIW-ALP0
      ARG2=ALCLM-ALP0
      ADOAD=ARG1/ARG2
      TL2OB=A(24)/WINGIN(4)
      SWA4=A(40)
      TRRT=A(118)
C
C              FIGURE 4.4.1-66
C
      CALL TLINEX(X155A1,X155A2,Y4155A,4,4,SWA4,ADOAD,TMP,
     1            0,1,2,0,Q44155,2,ROUTID)
      CALL TLINEX(X155B1,X155B2,Y4155B,3,2,TRRT,TMP,AEEFOA,
     1            0,0,0,0,Q44155,2,ROUTID)
      CALL TLINEX(X155C1,X155C2,Y4155C,2,7,TRRT,AEEFOA,BEFFOB,
     1            0,1,0,0,Q44155,2,ROUTID)
      AEFF=A(120)*AEEFOA
C
C              FIGURE 4.4.1-67
C
      CALL TLINEX(X156A1,X156A2,Y156A,6,13,AEFF,TL2OB,AN1,
     1            2,1,2,2,Q44156,2,ROUTID)
      CALL TLINEX(X156B1,X156B2,Y4156B,4,9,SAC4,AEFF,AN2,
     1            0,2,2,2,Q44156,2,ROUTID)
      Y=.8-(-AN1*AN2+AN1)/5.
      FANS=.8-Y+AN2
      BEFF=2.*WINGIN(4)*BEFFOB
      BEFFO2=BEFF/2.
      BDFF=WINGIN(4)-WINGIN(12)
      DIHD=BEFF*TAN(ABS(WINGIN(13)/RAD))
      IF(BEFFO2.GT.BDFF)DIHD=BDFF*TAN(WINGIN(13)/RAD)+(BEFFO2-BDFF)
     1                      *TAN(WINGIN(14)/RAD)
      AA=HH-DIHD/2.
      AOBVO2=ABS(2.*AA/BEFF)
      BHOBV=2.*HTIN(4)/BEFF
C
C              FIGURE 4.4.1-68B
C
      CALL TLINEX(X157B1,X157B2,Y4157B,4,14,AOBVO2,BHOBV,DEBODE,
     1           0,2,0,2,Q4157B,3,ROUTID)
      IF(KDEODA .EQ. 0) DEODA=DEBODE*FANS*CLAM/CLALS
C
C  ***TRANSONIC DYNAMIC PRESSURE AT THE TAIL***
C
      ARG=RL2/CBAR
      ZWC=0.68*SQRT(CD0*SREF/A(3)*(ARG+0.15))
      ZC=ARG*TAN(GAMMA)
      ARG1=2.42*SQRT(CD0*SREF/A(3))
      DQOQ=ARG1/(ARG+0.3)
      DJ=PI*ZC/(2.*ZWC)
      ARG=COS(DJ)**2
      IF(KQOQIN .EQ. 0) QOQINF=1.-DQOQ*ARG
      ARG1=(CLAWB+CLABW)*(1.-DEODA)*QOQINF
      CLAWBT=CLAWGB+ARG1
      CDOH=QOQINF*HT(1)
      IF(WINGIN(4)/HTIN(4) .LT. 1.5) GO TO 1000
C
C     CALCULATE (CM)ALPHA LINEARIZED ABOUT CL = 0
C
      BWHV(121) = -(SYNA(1)-SYNA(2)-TRA(105))/CBARR*CLAWGB
     1            -(SYNA(1)-SYNA(6)-AHT(161))/CBARR*ARG1
C
C     B-W-H SAME AS B-W-H-V, SET IOM TO SHOW THIS CORRESPONDENCE
C
      BWH(121) = BWHV(121)
 1000 CONTINUE
      RETURN
      END

      SUBROUTINE M29O35
C
C***  EXEC FOR OVERLAY 29, LATERAL STABILITY GEOMETRY DATA
C
      COMMON /OVERLY/  IJKDUM(8),NOVLY
      LOGICAL VERTUP
      LOGICAL  FLTC,OPTI,BO,WGPL,WGSC,SYNT,HTPL,HTSC,VTPL,VTSC,
     1         HEAD,PRPOWR,JETPOW,LOASRT,TVTPAN,SUPERS,SUBSON,
     2         TRANSN,HYPERS,SYMFP,ASYFP,TRIMC,TRIM,DAMP,
     3         HYPEF,TRAJET,BUILD,FIRST,DRCONV,PART,
     4         VFPL,VFSC,CTAB
      COMMON /FLOLOG/ FLTC,OPTI,BO,WGPL,WGSC,SYNT,HTPL,HTSC,VTPL,VTSC,
     1                HEAD,PRPOWR,JETPOW,LOASRT,TVTPAN,SUPERS,SUBSON,
     2                TRANSN,HYPERS,SYMFP,ASYFP,TRIMC,TRIM,DAMP,
     3                HYPEF,TRAJET,BUILD,FIRST,DRCONV,PART,
     4                VFPL,VFSC,CTAB
      COMMON /VTI/    VTIN(154), TVTIN(8), VFIN(154)
      COMMON /SYNTSS/ SYNA(19)
      COMMON /CONSNT/ PI,DEG,UNUSED,RAD
      COMMON /WINGD/  A(195),B(49)
      COMMON /SBETA/  STB(135),TRA(108),TRAH(108),STBH(135)
      COMMON /BDATA/  BD(762)
      COMMON /HTDATA/ AHT(195),BHT(48)
      COMMON /VTDATA/ AVT(195), AVF(195)
      COMMON /WINGI/  WINGIN(77)
      COMMON /HTI/    HTIN(154)
      COMMON /BODYI/  BODYIN(126)
      DIMENSION ROUTID(2),BODYDP(20)
      DIMENSION WTYPE(4),C1(6),C2(6)
      EQUIVALENCE (SYNA(10),VERTUP)
      DATA ROUTID/4HM29O,4H35  /
      DATA WTYPE/4HSTRA,4HDOUB,4HCRAN,4HCURV/
      DATA I1,I2/2*0/
      NOVLY=29
C
C---------       LATERAL STABILITY GEOMETRY CALCULATIONS         -------
C
      STB(2)= (WINGIN(4)-WINGIN(12))/WINGIN(4)
      STB(3)=1.0
      IF(WGPL.AND.(.NOT.BO)) GO TO 1050
      IF(.NOT.WGPL)GO TO 1060
      SINSYN=SIN(SYNA(4)/RAD)
      STB(1)=-SYNA(3)+(.25*A(10)+BD(66))*SINSYN-(WINGIN(4)-WINGIN(3))
     1       *TAN(WINGIN(13)/RAD)
      STB(4)=-SYNA(3)+WINGIN(6)/4.0*SINSYN
      STB(72)=(WINGIN(4)-WINGIN(3))*2.0
      STB(63)=SYNA(2)+BD(66)+WINGIN(2)*A(86)+A(23)*A(62)+WINGIN(1)/2.
      NV=BODYIN(1)+.5
      IF(BODYIN(82).EQ.UNUSED) GO TO 1010
      CALL TRAPZ(BODYIN(82),NV,BODYIN(2),VARU,1)
      CALL TRAPZ(BODYIN(102),NV,BODYIN(2),VARL,1)
      STB(62)=VARU-VARL
      QL=BD(1)*.25
      TFL=BD(1)*.75
      DO 1000 I=1,NV
 1000 BODYDP(I)=BODYIN(I+81)-BODYIN(I+101)
      CALL TBFUNX(QL,STB(61),DYDX,NV,BODYIN(2),BODYDP(1),C1,I1,MI,NG,
     1            0,0,4HQL  ,1,ROUTID)
      CALL TBFUNX(TFL,STB(60),DYDX,NV,BODYIN(2),BODYDP(1),C2,I2,MI,NG,
     1            0,0,4HTFL ,1,ROUTID)
      CALL GETMAX(BODYIN(2),BODYDP(1),NV,XMAX,STB(59),IMAX)
      GO TO 1020
 1010 CONTINUE
      CALL TRAPZ(BODYIN(62),NV,BODYIN(2),VAR,1)
      STB(62)=2.0*VAR
      QL=BD(1)*.25
      TFL=BD(1)*.75
      CALL TBFUNX(QL,VAR,DYDX,NV,BODYIN(2),BODYIN(62),C1,I1,MI,NG,
     1            0,0,4HQL  ,1,ROUTID)
      STB(61)=2.*VAR
      CALL TBFUNX(TFL,VAR,DYDX,NV,BODYIN(2),BODYIN(62),C2,I2,MI,NG,
     1            0,0,4HTFL ,1,ROUTID)
      STB(60)=2.*VAR
      CALL GETMAX(BODYIN(2),BODYIN(62),NV,XMAX,RMAX,IMAX)
      STB(59)=2.*RMAX
 1020 CONTINUE
      CALL GETMAX(BODYIN(2),BODYIN(62),NV,XMAX,RMAX,IMAX)
      STB(123)=2.*RMAX
      IF(.NOT.VTPL)GO TO 1050
      STB(11)=(SYNA(9)-SYNA(1))+AVT(195)+AVT(122)/4.0
      STB(12)=-SYNA(5)+AVT(136)
      IF(.NOT.VERTUP)STB(12)=-SYNA(5)-AVT(136)
      IF(.NOT.HTPL.OR.SYNA(7).LT.0.0) GO TO 1050
      XPART=SYNA(6)+AHT(161)-SYNA(9)
      IF(VTIN(15).NE.WTYPE(1)) GO TO 1030
      STB(9)=XPART-SYNA(7)*AVT(62)
      STB(10)=VTIN(6)-(VTIN(6)-VTIN(1))*SYNA(7)/VTIN(4)
      GO TO 1050
 1030 IF(SYNA(7).GT.(VTIN(4)-VTIN(2))) GO TO 1040
      STB(9)=XPART-SYNA(7)*AVT(62)
      STB(10)=VTIN(6)-(VTIN(6)-VTIN(5))*SYNA(7)/(VTIN(4)-VTIN(2))
      GO TO 1050
 1040 STB(9)=XPART-(VTIN(4)-VTIN(2))*AVT(62)-(SYNA(7)+VTIN(2)
     1       -VTIN(4))*AVT(86)
      STB(10)=VTIN(1)+(VTIN(5)-VTIN(1))*(VTIN(4)-SYNA(7))/VTIN(2)
 1050 CONTINUE
C
C     CALCULATION OF EFFECTIVE DIHEDRAL ANGLE
C
      IF(WINGIN(13).EQ.UNUSED)WINGIN(13)=0.0
      IF(WINGIN(12).EQ.UNUSED)WINGIN(12)=0.0
      IF(WINGIN(14).EQ.UNUSED)WINGIN(14)=WINGIN(13)
      STB(122)=(WINGIN(13)*(WINGIN(3)-WINGIN(12))+WINGIN(14)*WINGIN(12))
     1         /WINGIN(3)
C
      IF(WGPL.AND.(.NOT.BO).AND.(.NOT.HTPL))RETURN
 1060 IF(.NOT.HTPL) RETURN
      STBH(2)= (HTIN(4)-HTIN(12))/HTIN(4)
      STBH(3)=1.0
      IF(HTPL.AND.(.NOT.BO)) GO TO 1120
      SINSYN=SIN(SYNA(8)/RAD)
      STBH(1)=-SYNA(7)+(.25*A(10)+BD(66))*SINSYN-(HTIN(4)-HTIN(3))
     1        *TAN(HTIN(13)/RAD)
      STBH(4)=-SYNA(7)+HTIN(6)/4.0*SINSYN
      STBH(72)=(HTIN(4)-HTIN(3))*2.0
      STBH(63)=SYNA(6)+BD(66)+HTIN(2)*AHT(86)+AHT(23)*AHT(62)+HTIN(1)/2.
      NV=BODYIN(1)+.5
      IF(BODYIN(82).EQ.UNUSED) GO TO 1080
      CALL TRAPZ(BODYIN(82),NV,BODYIN(2),VARU,1)
      CALL TRAPZ(BODYIN(102),NV,BODYIN(2),VARL,1)
      STBH(62)=VARU-VARL
      QL=BD(1)*.25
      TFL=BD(1)*.75
      DO 1070 I=1,NV
 1070 BODYDP(I)=BODYIN(I+81)-BODYIN(I+101)
      CALL TBFUNX(QL,STBH(61),DYDX,NV,BODYIN(2),BODYDP(1),C1,I1,MI,NG,
     1            0,0,4HQL  ,1,ROUTID)
      CALL TBFUNX(TFL,STBH(60),DYDX,NV,BODYIN(2),BODYDP(1),C2,I2,MI,NG,
     1            0,0,4HTFL ,1,ROUTID)
      CALL GETMAX(BODYIN(2),BODYDP(1),NV,XMAX,STBH(59),IMAX)
      GO TO 1090
 1080 CONTINUE
      CALL TRAPZ(BODYIN(62),NV,BODYIN(2),VAR,1)
      STBH(62)=2.0*VAR
      QL=BD(1)*.25
      TFL=BD(1)*.75
      CALL TBFUNX(QL,VAR,DYDX,NV,BODYIN(2),BODYIN(62),C1,I1,MI,NG,
     1            0,0,4HQL  ,1,ROUTID)
      STBH(61)=2.*VAR
      CALL TBFUNX(TFL,VAR,DYDX,NV,BODYIN(2),BODYIN(62),C2,I2,MI,NG,
     1            0,0,4HTFL ,1,ROUTID)
      STBH(60)=2.*VAR
      CALL GETMAX(BODYIN(2),BODYIN(62),NV,XMAX,RMAX,IMAX)
      STBH(59)=2.*RMAX
 1090 CONTINUE
      CALL GETMAX(BODYIN(2),BODYIN(62),NV,XMAX,RMAX,IMAX)
      STBH(123)=2.*RMAX
      IF(.NOT.VFPL)GO TO 1120
      STBH(11)=(SYNA(12)-SYNA(1))+AVF(195)+AVF(122)/4.0
      STBH(12)=-SYNA(5)+AVF(136)
      IF(VERTUP)STBH(12)=-SYNA(5)-AVF(136)
      IF(.NOT.HTPL.OR.SYNA(7).LT.0.0) GO TO 1120
      XPART=SYNA(6)+AHT(161)-SYNA(12)
      IF(VFIN(15).NE.WTYPE(1)) GO TO 1100
      STBH(9)=XPART-SYNA(7)*AVF(62)
      STBH(10)=VFIN(6)-(VFIN(6)-VFIN(1))*SYNA(7)/VFIN(4)
      GO TO 1120
 1100 IF(SYNA(7).GT.(VFIN(4)-VFIN(2))) GO TO 1110
      STBH(9)=XPART-SYNA(7)*AVF(62)
      STBH(10)=VFIN(6)-(VFIN(6)-VFIN(5))*SYNA(7)/(VFIN(4)-VFIN(2))
      GO TO 1120
 1110 STBH(9)=XPART-(VFIN(4)-VFIN(2))*AVF(62)-(SYNA(7)+VFIN(2)
     1        -VFIN(4))*AVF(86)
      STBH(10)=VFIN(1)+(VFIN(5)-VFIN(1))*(VFIN(4)-SYNA(7))/VFIN(2)
 1120 CONTINUE
C
C     CALCULATION OF EFFECTIVE DIHEDRAL ANGLE
C
      IF(HTIN(13).EQ.UNUSED)HTIN(13)=0.0
      IF(HTIN(12).EQ.UNUSED)HTIN(12)=0.0
      IF(HTIN(14).EQ.UNUSED)HTIN(14)=HTIN(13)
      STBH(122)=(HTIN(13)*(HTIN(3)-HTIN(12))+HTIN(14)*HTIN(12))
     1          /HTIN(3)
      STBH(123) = STB(123)
      RETURN
      END

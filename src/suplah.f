      SUBROUTINE SUPLAH
C
C ************SUPERSONIC LATERAL STABILITY************
C                    HORIZONTAL TAIL
C                 BODY-HORIZONTAL TAIL
C
      COMMON /FLOLOG/FLTC,OPTI,BO,WGPL,WGSC,SYNT,HTPL,HTSC,VTPL,VTSC
      COMMON /OPTION/ SR,CRBAR,ROUGFC,BLREF
      COMMON /FLGTCD/ FLC(95)
      COMMON /CONSNT/ PI,DEG,UNUSED,RAD
      COMMON /BDATA/  BD(762)
      COMMON /OVERLY/ NLOG,NMACH,I,NALPHA
      COMMON /SYNTSS/ SYNA(19)
      COMMON /HTDATA/ A(195)
      COMMON /SUPWH/  SLGG(141),SLG(141)
      COMMON /SBETA/  SLAA(31),SLA(31)
      COMMON /SUPBOD/ SBD(227)
      COMMON /BODYI/  BODYIN(126)
      COMMON /HTI/    WINGIN(100)
      COMMON /IHT/    PWING, WING(380)
      COMMON /IBH/    PBW, BWI(380)
C
      LOGICAL FLTC,OPTI,BO,WGPL,WGSC,SYNT,HTPL,HTSC,VTPL,VTSC
C
      DIMENSION ROUTID(2)
      DIMENSION Q51116(3),Q71118(3),Q225AE(3),Q52318(3)
      REAL MACH
      DIMENSION SEXT(20),SVB(20),SVWB(20),RLPH(20)
      DIMENSION VAR(4),LGH(4)
      DIMENSION C1(6),C2(6)
      DIMENSION X158A(10),X258A(2),Y58A(20),X158B(5),X258B(3),Y58B(15),
     1          X158C(5),X258C(2),Y58C(10)
      DIMENSION WTYPE(4)
      DIMENSION X12225(39),Y2225A(119),Y2225B(119),Y2225C(119),
     1          Y2225D(119),Y2225E(119),Y12225(595)
      DIMENSION X71118(8),Y71118(8),X51116(16),Y51116(16)
      DIMENSION CLB(20),ALPHA(20),CLBWB(20),SHB(20),SVHB(20),
     1          CLBW(20),CNW(20),CYBW(20),CNBW(20)
C
      EQUIVALENCE (TANMID,A(74))
      EQUIVALENCE (SLA(3),X),(DIHEQ,SLA(4)),(CYBW(1),WING(141)),
     1(QBC,SLA(5)),(EBC,SLA(6)),(CLPTOA,SLA(7)),(CLP,SLA(8))
     2,(CLBD,SLA(9)),(CLBW(1),WING(181)),(ZW,SLA(10)),(RKI,SLA(11)),
     3(CYBWB,BWI(141)),(RNN,SLA(12)),(RKRL,SLA(13)),(RH1,SLA(14)),(RH2,
     4SLA(15)),(SBS,SLA(16)),(RKN,SLA(17)),(CNBWB,BWI(161))
     5,(CNBW(1),WING(161))
      EQUIVALENCE (ZWP,SLA(18)),(CLBZW,SLA(19)),(DCLB,SLA(20)),(CLBWB(1)
     1,BWI(181))
      EQUIVALENCE (MACH,SLA(1)),(BETA,SLA(2)),(SWEPE,A(59)),(TAPR,A(118)
     1),(AR,A(120)),(TANLE,A(62)),(XW,SYNA(6)),(CR,WINGIN(6)),
     2(XCG,SYNA(1)),(ALPHA(1),FLC(23)),(SPAN,WINGIN(4)),(SLG(3),CLPCTY),
     3(COSLE,A(61)),(CNW(1),WING(61)),(CNAW,SLG(7))
      EQUIVALENCE (SPANO,WINGIN(3)),(CLAB,SBD(18)),(RLB,BD(1)),
     1(ALPHAI,SYNA(8))
      EQUIVALENCE (Y12225(1),Y2225A(1)),(Y12225(120),Y2225B(1)),
     1(Y12225(239),Y2225C(1)),(Y12225(358),Y2225D(1)),(Y12225(477),
     2 Y2225E(1))
C
      DATA ROUTID/4HSUPL,4HAH  /
      DATA Q51116/4H5.1.,4H1.1-,4H6   /,Q71118/4H7.1.,4H1.1-,4H8   /,
     1     Q225AE/4H7.1.,4H2.2-,4H25AE/,Q52318/4H5.2.,4H3.1-,4H8   /
      DATA WTYPE/4HSTRA,4HDOUB,4HCRAN,4HCURV/
C
C                         FIGURE 5.2.3.1-8A
C
      DATA X158A/20.,14.,10.,8.,7.,6.,5.,4.,3.,2.5/
      DATA X258A/.2,.8/
      DATA Y58A/.1,1.88,
     1.40,2.21,
     2.74,2.60,
     3.98,2.80,
     41.30,3.13,
     51.61,3.50,
     62.00,3.88,
     72.50,4.40,
     82.99,5.00,
     93.45,5.40/
C                        FIGURE 5.2.3.1-8B
C
      DATA X158B/.8,1.0,1.2,1.4,1.6/
      DATA X258B/0.0,3.0,6.0/
      DATA Y58B/0.0,2.35,4.68,
     10.0,3.00,6.00,
     20.0,3.60,7.25,
     30.0,4.18,8.50,
     40.0,4.79,9.50/
C
C                        FIGURE 5.2.3.1-8C
C
      DATA X158C/.5,.6,.8,1.,2./
      DATA X258C/0.0,6.0/
      DATA Y58C/-.00048,.00251,
     1-.00048,.0035,
     2-.00048,.00477,
     3-.00048,.00559,
     4-.00048,.00641/
C
C     ----FIGURE 7.1.1.1-8 ELLIPTIC INTEGRAL OF THE STABILITY DERIVATIVE
C
      DATA X71118 /0.,.05,.1,.165,.25,.35,.8,1.0/
      DATA Y71118 /1.0,.995,.985,.966,.940,.90,.705,.631/
C
C     ----FIGURE 5.1.1.1-6 ELLIPTIC INTEGRAL FACTOR OF STABILITY DERIV.
C
      DATA X51116/0.,.1,.2,.45,.55,.65,.7,.75,.8,.85,.875,.9,.95,.974,
     1 .99,1.0/
      DATA Y51116/1.,1.028,1.078,1.241,1.284,1.3,1.287,1.26,1.207,1.125,
     11.05,.970,.75,.55,.350,0./
C
C----FIGURE 7.1.2.2.-25 (A-E) ROLL DAMPING PARAMETER.
C
      DATA X12225/0.,1.,2.,2.45,3.,3.31,4.,4.7,5.,5.3,5.75,6.,6.7,7.,8.,
     19.,10.,
     20.0,1.,2.,3.,4.,5.,6.,10*0.0,
     30.0,.25,.50,.75,1.0/
      DATA Y2225A /-.098,-.1025,-.1067,-.1088,-.0954,-.087,-.075,-.065,
     1-.0615,-.0585,-.054,-.052,-.047,-.0455,-.0408,-.0363,-.0338      ,
     2-.098,-.099,-.1008,-.1015,-.099,-.09,-.077,-.0666,-.063,-.06,-.055
     3,-.0535,-.048,-.0465,-.0414,-.0368,-.0335    , -.098,-.0958,-.0925
     4,-.0908,-.0888,-.087,-.085,-.071,-.0665,-.064,-.0578,-.0555,-.050,
     5-.048,-.0424,-.0376,-.034   ,-.085,-.082,-.0814,-.0806,-.079,-.078
     6,-.0764,-.074,-.073,-.068,-.062,-.060,-.053,-.051,-.044,-.0387,
     7-.0345   ,-.0748,-.074,3*-.073,-.0729,-.0713,-.0696,-.0686,-.0678,
     8-.066,-.065,-.056,-.0531,-.046,-.040,-.0350   ,-.0665,-.0668,-.067
     9,-.067,-.0672,-.067,-.0663,-.065,-.0647,-.064,-.063,-.0627,-.0610,
     A-.060,-.0497,-.0425,-.037    ,-.0575,-.0585,-.06,-.0605,-.0614,
     B-.0616,-.0626,-.062,-.0615,-.061,-.060,-.0599,-.0582,-.058,-.0558,
     C-.0454,-.040 /
      DATA Y2225B /-.0985,-.116,-.135,-.1285,-.1185,-.113,-.098,-.0865,
     1-.081,-.077,-.072,-.0695,-.0635,-.061,-.054,-.049,-.0445        ,
     2-.0985,-.1115,-.125,-.123,-.1165,-.110,-.101,-.0895,-.0833,-.080,
     3-.073,-.071,-.0645,-.062,-.055,-.0495,-.045    ,-.0985,-.1058,
     4-.113,-.112,-.1108,-.110,-.101,-.0905,-.085,-.0815,-.075,-.0728,
     5-.0655,-.063,-.056,-.05,-.0455    ,-.092,-.097,-.1025,-.1028,-.102
     6,-.101,-.098,-.0925,-.088,-.0845,-.079,-.076,-.069,-.0655,-.058,
     7-.0516,-.0465    ,-.084,-.0871,-.0905,-.092,-.0936,-.0931,-.0913,
     8-.089,-.088,-.087,-.082,-.0795,-.0725,-.069,-.061,-.0542,-.049
     9,-.0765,-.0776,-.0788,-.081,-.083,-.084,-.086,-.0843,-.0835,-.083,
     A-.0814,-.0806,-.076,-.0731,-.0644,-.057,-.0509   ,-.069,-.0696,
     B-.070,-.072,-.0739,-.0746,-.077,-.0786,-.0789,-.0783,-.0773,-.077,
     C-.075,-.0735,-.0684,-.0606,-.0536 /
      DATA Y2225C /-.098,-.119,-.1375,-.131,-.123,-.118,-.1055,-.095,
     1-.090,-.086,-.0815,-.0777,-.0712,-.0682,-.0619,-.056,-.0512,
     2-.098,-.114,-.131,-.127,-.121,-.1175,-.1055,-.0977,-.0938,-.086,
     3-.0815,-.0782,-.0721,-.069,-.062,-.056,-.0512     ,-.098,-.1088,
     4-.119,-.1182,-.1155,-.1133,-.1055,-.0977,-.0940,-.089,-.0842,-.081
     5,-.0730,-.0692,-.0620,-.056,-.0512     ,-.095,-.1011,-.1075,-.1091
     6,-.1081,-.1078,-.104,-.0977,-.0950,-.0905,-.086,-.0831,-.076,-.073
     7,-.0645,-.0576,-.052    ,-.0875,-.091,-.094,-.0958,-.0982,-.0996,
     8-.0985,-.0977,-.0950,-.0915,-.0879,-.0855,-.0791,-.076,-.0675,
     9-.0605,-.0548      ,-.0816,-.0822,-.0826,-.0843,-.0865,-.0875,
     A-.0905,-.0906,-.0899,-.0886,-.0879,-.0855,-.0806,-.0778,-.070,
     B-.063,-.056     ,-.0738,-.073,-.0725,-.0740,-.076,-.0770,-.08,
     C-.0827,-.084,-.085,-.0845,-.0841,-.083,-.081,-.073,-.0657,-.059  /
      DATA Y2225D /-.0989,-.120,-.1415,-.1335,-.124,-.119,-.108,-.099,
     1-.094,-.090,-.0861,-.083,-.0775,-.074,-.066,-.060,-.0545         ,
     2-.0989,-.1145,-.1311,-.1265,-.120,-.117,-.108,-.099,-.094,-.090,
     3-.0861,-.083,-.0775,-.074,-.066,-.060,-.0545     ,-.0989,-.108,
     4-.1171,-.121,-.117,-.1144,-.107,-.100,-.096,-.093,-.0882,-.085,
     5-.0795,-.075,-.067,-.0605,-.055     ,-.0959,-.0999,-.1038,-.1056,
     6-.1085,-.111,-.1054,-.100,-.097,-.0935,-.090,-.0865,-.0816,-.0775,
     7-.069,-.0623,-.0565     ,-.0899,-.0906,-.0915,-.096,-.098,-.099,
     8-.101,-.100,-.0972,-.0950,-.092,-.089,-.0841,-.0806,-.0725,-.065,
     9-.0585     ,-.083,-.082,-.081,-.0845,-.088,-.0898,-.093,-.094,
     A-.0935,-.0934,-.092,-.0900,-.086,-.0825,-.0745,-.067,-.060       ,
     B-.0765,-.0746,-.073,-.076,-.0798,-.0815,-.0846,-.086,-.0867,-.0875
     C,-.0875,-.0865,-.0841,-.0825,-.0755,-.0686,-.062  /
      DATA Y2225E /-.098,-.1135,-.1283,-.130,-.1245,-.1200,-.1090,-.100,
     1-.0960,-.0915,-.0881,-.0860,-.0794,-.076,-.0681,-.062,-.057      ,
     2-.098,-.112,-.1255,-.1265,-.1230,-.1190,-.1090,-.100,-.096,-.0915,
     3-.0881,-.0860,-.0794,-.076,-.0681,-.062,-.057    ,-.098,-.1051,
     4-.1125,-.1180,-.1178,-.1160,-.1090,-.102,-.0985,-.0935,-.09,-.0868
     5,-.0815,-.0775,-.0695,-.063,-.0578    ,-.100,-.091,-.1040,-.1083,
     6-.114,-.1128,-.1075,-.1020,-.0985,-.0950,-.092,-.089,-.0831,-.0795
     7,-.072,-.065,-.059     ,-.090,-.0912,-.0920,-.0955,-.0994,-.1010,
     8-.1045,-.102,-.0980,-.0950,-.0930,-.09,-.0850,-.0811,-.073,-.066,
     9-.0606     ,-.0832,-.0823,-.0815,-.0850,-.0889,-.0910,-.094,-.0956
     A,-.096,-.096,-.093,-.0905,-.0860,-.083,-.075,-.0682,-.0625       ,
     B-.076,-.0743,-.0725,-.0751,-.0787,-.0810,-.084,-.0870,-.088,-.089,
     C-.0895,-.090,-.0867,-.084,-.0767,-.0705,-.065   /
C
C  *** CYB WING ALONE ***
C
      SCALE=2.*WINGIN(4)/BLREF
      MACH=FLC(I +2)
      BETA=SQRT(MACH**2-1.)
      NX=BODYIN(1)+.5
      RLB=BODYIN(NX+1)
      RM=MACH**2
      RB=BETA**2
      IF(WINGIN(13).EQ.UNUSED)WINGIN(13)=0.0
      IF(WINGIN(12).EQ.UNUSED)WINGIN(12)=0.0
      IF(WINGIN(14).EQ.UNUSED)WINGIN(14)=0.0
      ARG=WINGIN(3)-WINGIN(12)
      DIHEQ=(WINGIN(13)*ARG+WINGIN(14)*WINGIN(12))/WINGIN(3)
      IF(WINGIN(15).NE.WTYPE(1)) GO TO 1060
      IF(SWEPE.EQ.0.AND.TAPR.EQ.1.AND.(AR*BETA.GE.1.0))GO TO 1000
      ARG=BETA/.00001
      IF(TANLE.NE.0.0)ARG=BETA/TANLE
      IF(TAPR.EQ.0.0.AND.(ARG.LE.1.0))GO TO 1020
      GO TO 1040
 1000 CONTINUE
      X=XW+0.5*CR-XCG
      ARG1= 1./(PI*AR**2*RB)
      ARG2=4.*RM/3.+8.*RM*X/CRBAR
      ARG3=PI* AR*(1.-RB)*(3.+RB)/(3.*BETA**3)
      DO 1010 J=1,NALPHA
         ALP= (ALPHA(J)/RAD)**2
         CYBW(J)=-ALP*8.0*RM/(RAD*PI*RB*AR) -.0001*ABS(DIHEQ)
C
C  *** CNB WING ALONE ***
C
         CNBW(J)=SCALE*ALP*ARG1*(ARG2-ARG3)/RAD
 1010 CONTINUE
      GO TO 1040
 1020 CONTINUE
C
C              FIGURE 5.1.1.1-6 (1./Q(BC))
C
      VAR(1)=ARG
      LGH(1)=16
      CALL INTERX(1,X51116,VAR,LGH,Y51116,QBC,16,16,
     1            0,0,0,0,0,0,0,0,Q51116,3,ROUTID)
C
C              FIGURE 7.1.1.1-8 (EBC)
C
      LGH(1)=8
      CALL INTERX(1,X71118,VAR,LGH,Y71118,EBC,8,8,
     1            0,0,0,0,0,0,0,0,Q71118,3,ROUTID)
      ARG1= PI*AR*RM/(4.*RAD*QBC)
      X=XW+.6666*SPAN*TANLE-XCG
      ARG2=PI/3.*(EBC+(AR**2/16.+X/CRBAR)*RM/QBC)/RAD
      DO 1030 J=1,NALPHA
         ALP= (ALPHA(J)/RAD)**2
         CYBW(J)=-ALP*ARG1-.0001*ABS(DIHEQ)
 1030 CNBW(J)=SCALE*ALP*ARG2
 1040 CONTINUE
C
C *** CLB WING ALONE ***
C              FIGURE 7.1.2.2-25A-E  (CLPTOA)
C
      VAR(1)=BETA*AR
      VAR(2)=AR*TANMID
      VAR(3)=TAPR
      LGH(1)=17
      LGH(2)=7
      LGH(3)=5
      CALL INTERX(3,X12225,VAR,LGH,Y12225,CLPTOA,17,597,
     1            0,0,0,0,2,2,0,0,Q225AE,3,ROUTID)
      CLP= CLPTOA*AR*CLPCTY
      CLBD=2.*DIHEQ*(1.+2.*TAPR)*CLP/(RAD**2.*(1.+3.*TAPR))
      ARG1=(1.+TAPR*(1.+SWEPE))*(1.+SWEPE/2.)*TANLE/BETA
      ARG2= RM*COSLE**2/AR+(TANLE/4.)**1.3333
      DO 1050 J=1,NALPHA
 1050 CLBW(J)=SCALE*(CLBD-0.061*CNW(J)*CNAW*ARG1*ARG2/RAD)
C
C  *** CYB WING-BODY ***
C
 1060 IF(.NOT.BO)RETURN
      SPANIN=SPAN-SPANO
      ARG=SIN(SYNA(8)/RAD)
      ZW=-SYNA(7)+(.25*A(10)+BD(89))*ARG-SPANIN*TAN(WINGIN(13)/RAD)
      ARG=ZW/(SPANIN)
      RKI= 1.0+.49*ARG
      IF(ARG.LT.0.0)RKI=1.0-.85*ARG
      CYBWB=-RKI*CLAB-0.0001*ABS(DIHEQ)
C
C  *** CNB WING-BODY ***
C
      RNN=FLC(I +42)*RLB
C
C              EQUATION FOR FIG.5.2.3.1-9 KRL
C
      RKRL=1.+ALOG(1.E-6*RNN)/4.86
      ARG11=1.0
      NV=BODYIN(1)+.5
      QL=RLB*.25
      TFL=RLB*.75
      I1=0
      I2=0
      CALL TBFUNX(QL,RH1,DYDX,NV,BODYIN(2),BODYIN(62),C1,I1,MI,NG,
     1            0,0,4HRH1 ,1,ROUTID)
      RH1=2.*RH1
      CALL TBFUNX(TFL,RH2,DYDX,NV,BODYIN(2),BODYIN(62),C2,I2,MI,NG,
     1            0,0,4HRH2 ,1,ROUTID)
      RH2=2.*RH2
      ARG12=SQRT(RH1/RH2)
      CALL TRAPZ(BODYIN(62),NV,BODYIN(2),SBS,1)
      SBS=2.*SBS
      ARG13=RLB**2/SBS
      ARG14=XCG/RLB
C
C                   FIGURE 5.2.3.1-8 (KN)
C
      CALL TLINEX(X158A,X258A,Y58A,10,2,ARG13,ARG14,YDUMY,
     1            2,1,2,1,Q52318,3,ROUTID)
      CALL TLINEX(X158B,X258B,Y58B,5,3,ARG12,YDUMY,YDUMY2,
     1            2,0,2,1,Q52318,3,ROUTID)
      CALL TLINEX(X158C,X258C,Y58C,5,2,ARG11,YDUMY2,RKN,
     1            2,0,2,1,Q52318,3,ROUTID)
      CNBWB=-RKN*RKRL*SBS*RLB/(SR*BLREF)
      IF(WINGIN(15).NE.WTYPE(1)) GO TO 1080
C
C  *** CLB WING-BODY ***
C
      ZWP=ZW+CR*SIN(ALPHAI/RAD)/4.0
      ARG1=SQRT(AR)
      DBODY = 2.0*SPANIN
      CLBZW =  0.6*ARG1*ZWP*DBODY/(RAD*SPAN**2)
      ARG= (DBODY/(2.*SPAN))**2*DIHEQ
      DCLB=-0.0005*ARG1*ARG
      ARG2=CLBZW+DCLB
      DO 1070 J=1,NALPHA
 1070 CLBWB(J)=CLBW(J)+ARG2*SCALE
 1080 CONTINUE
      RETURN
      END
